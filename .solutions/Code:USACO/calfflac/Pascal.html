<!DOCTYPE html>
<html lang="zh-cn" dir="ltr" class="client-nojs">
<head>
<title>Code:USACO/calfflac/Pascal - NOCOW</title>
<meta charset="UTF-8" />
<meta name="generator" content="MediaWiki 1.18.1" />
<link rel="alternate" type="application/x-wiki" title="编辑" href="http://www.nocow.cn/index.php?title=Code:USACO/calfflac/Pascal&amp;action=edit" />
<link rel="edit" title="编辑" href="http://www.nocow.cn/index.php?title=Code:USACO/calfflac/Pascal&amp;action=edit" />
<link rel="shortcut icon" href="http://www.nocow.cn/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="http://www.nocow.cn/opensearch_desc.php" title="NOCOW (zh-cn)" />
<link rel="EditURI" type="application/rsd+xml" href="http://www.nocow.cn/api.php?action=rsd" />
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html" />
<link rel="alternate" type="application/atom+xml" title="NOCOW的Atom" href="http://www.nocow.cn/index.php?title=%E7%89%B9%E6%AE%8A:%E6%9C%80%E8%BF%91%E6%9B%B4%E6%94%B9&amp;feed=atom" />
<link rel="stylesheet" href="http://www.nocow.cn/load.php?debug=false&amp;lang=zh-cn&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cskins.monobook&amp;only=styles&amp;skin=monobook&amp;*" />
<!--[if lt IE 5.5000]><link rel="stylesheet" href="/skins/monobook/IE50Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 5.5000]><link rel="stylesheet" href="/skins/monobook/IE55Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 6]><link rel="stylesheet" href="/skins/monobook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/skins/monobook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="http://www.nocow.cn/load.php?debug=false&amp;lang=zh-cn&amp;modules=site&amp;only=styles&amp;skin=monobook&amp;*" />
<style>a:lang(ar),a:lang(ckb),a:lang(fa),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}a.new,#quickbar a.new{color:#ba0000}

/* cache key: newnocow:resourceloader:filter:minify-css:4:c88e2bcd56513749bec09a7e29cb3ffa */
</style>
<script src="http://www.nocow.cn/load.php?debug=false&amp;lang=zh-cn&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
	mw.config.set({"wgCanonicalNamespace": "Code", "wgCanonicalSpecialPageName": false, "wgNamespaceNumber": 104, "wgPageName": "Code:USACO/calfflac/Pascal", "wgTitle": "USACO/calfflac/Pascal", "wgCurRevisionId": 32933, "wgArticleId": 187, "wgIsArticle": true, "wgAction": "view", "wgUserName": null, "wgUserGroups": ["*"], "wgCategories": [], "wgBreakFrames": false, "wgRestrictionEdit": [], "wgRestrictionMove": []});
}
</script><script>if(window.mw){
	mw.loader.load(["mediawiki.page.startup"]);
}
</script>
<style type="text/css">/*<![CDATA[*/
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for pascal
 * CSS class: source-pascal, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.pascal.source-pascal .de1, .pascal.source-pascal .de2 {}
.pascal.source-pascal  {font-family:monospace;}
.pascal.source-pascal .imp {font-weight: bold; color: red;}
.pascal.source-pascal li, .pascal.source-pascal .li1 {font-weight: normal; vertical-align:top;}
.pascal.source-pascal .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.pascal.source-pascal .li2 {font-weight: bold; vertical-align:top;}
.pascal.source-pascal .kw1 {color: #000000; font-weight: bold;}
.pascal.source-pascal .kw2 {color: #000000; font-weight: bold;}
.pascal.source-pascal .kw3 {color: #000066;}
.pascal.source-pascal .kw4 {color: #000066; font-weight: bold;}
.pascal.source-pascal .co1 {color: #666666; font-style: italic;}
.pascal.source-pascal .coMULTI {color: #666666; font-style: italic;}
.pascal.source-pascal .es0 {color: #000099; font-weight: bold;}
.pascal.source-pascal .es_h {color: #000099; font-weight: bold;}
.pascal.source-pascal .br0 {color: #009900;}
.pascal.source-pascal .sy0 {color: #339933;}
.pascal.source-pascal .st0 {color: #ff0000;}
.pascal.source-pascal .st_h {color: #ff0000;}
.pascal.source-pascal .nu0 {color: #cc66cc;}
.pascal.source-pascal .me1 {color: #0066ee;}
.pascal.source-pascal .ln-xtra, .pascal.source-pascal li.ln-xtra, .pascal.source-pascal div.ln-xtra {background-color: #ffc;}
.pascal.source-pascal span.xtra { display:block; }

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
@import "http://www.nocow.cn/index.php?title=MediaWiki:Geshi.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
/*]]>*/
</style></head>
<body class="mediawiki ltr sitedir-ltr ns-104 ns-subject page-Code_USACO_calfflac_Pascal action-view skin-monobook">
<div id="globalWrapper">
<div id="column-content"><div id="content">
	<a id="top"></a>
	<div id="siteNotice"><div id="localNotice" lang="zh-cn" dir="ltr"><p>为防止广告，目前nocow只有登录用户能够创建新页面。如要创建页面请先<a href="http://www.nocow.cn/index.php/%E7%89%B9%E6%AE%8A:%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95" title="特殊:用户登录">登录/注册</a>（新用户需要等待1个小时才能正常使用该功能）。
</p></div></div>
	<h1 id="firstHeading" class="firstHeading">Code:USACO/calfflac/Pascal</h1>
	<div id="bodyContent">
		<div id="siteSub">来自NOCOW</div>
		<div id="contentSub"></div>
		<div id="jump-to-nav">跳转到： <a href="Pascal.html#column-one">导航</a>, <a href="Pascal.html#searchInput">搜索</a></div>
		<!-- start content -->
<div lang="zh-cn" dir="ltr" class="mw-content-ltr"><p>&lt;很朴素的算法，空间复杂度和时间复杂度可以接受，存储比较有特色……&gt;
Executing...
</p>
<pre>  Test 1: TEST OK [0.000 secs, 324 KB]
  Test 2: TEST OK [0.000 secs, 324 KB]
  Test 3: TEST OK [0.000 secs, 324 KB]
  Test 4: TEST OK [0.000 secs, 324 KB]
  Test 5: TEST OK [0.000 secs, 324 KB]
  Test 6: TEST OK [0.011 secs, 324 KB]
  Test 7: TEST OK [0.000 secs, 324 KB]
  Test 8: TEST OK [0.205 secs, 324 KB]
</pre>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="kw1">Var</span>
 nodenum <span class="sy0">,</span> nodeword <span class="sy0">:</span> <span class="kw4">array</span> <span class="br0">&#91;</span> <span class="nu0">0</span>..<span class="nu0">20001</span> <span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">char</span>&#160;;
 sumans <span class="sy0">,</span> ans1 <span class="sy0">,</span> ans2 <span class="sy0">,</span> be <span class="sy0">,</span> start <span class="sy0">,</span> i <span class="sy0">,</span> j <span class="sy0">,</span> dd <span class="sy0">,</span> sumword <span class="sy0">,</span> sumnum <span class="sy0">:</span> <span class="kw4">longint</span>&#160;;
 recnum <span class="sy0">,</span> recword <span class="sy0">:</span> <span class="kw4">array</span> <span class="br0">&#91;</span> <span class="nu0">0</span>..<span class="nu0">20001</span> <span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>&#160;;
 st <span class="sy0">:</span> <span class="kw4">string</span>&#160;;
<span class="kw1">Procedure</span> get1 <span class="br0">&#40;</span> <span class="kw1">var</span> a <span class="sy0">:</span> <span class="kw4">longint</span> <span class="br0">&#41;</span>&#160;;
 <span class="kw1">begin</span>
  inc <span class="br0">&#40;</span> sumword <span class="br0">&#41;</span>&#160;;
  <span class="kw1">if</span> a &lt;<span class="sy0">=</span> <span class="nu0">20000</span> <span class="kw1">then</span> recword<span class="br0">&#91;</span>a<span class="br0">&#93;</span> <span class="sy0">:=</span> sumword
                 <span class="kw1">else</span> recnum<span class="br0">&#91;</span>a <span class="sy0">-</span> <span class="nu0">20000</span><span class="br0">&#93;</span> <span class="sy0">:=</span> sumword&#160;;
  a <span class="sy0">:=</span> sumword&#160;;
 <span class="kw1">end</span>;
&#160;
<span class="kw1">Procedure</span> get2 <span class="br0">&#40;</span> <span class="kw1">var</span> a <span class="sy0">:</span> <span class="kw4">longint</span> <span class="br0">&#41;</span>&#160;;
 <span class="kw1">begin</span>
  inc <span class="br0">&#40;</span> sumnum <span class="br0">&#41;</span>&#160;;
  <span class="kw1">if</span> a &lt;<span class="sy0">=</span> <span class="nu0">20000</span> <span class="kw1">then</span> recword<span class="br0">&#91;</span>a<span class="br0">&#93;</span> <span class="sy0">:=</span> sumnum <span class="sy0">+</span> <span class="nu0">20000</span>
                <span class="kw1">else</span> recnum<span class="br0">&#91;</span>a <span class="sy0">-</span> <span class="nu0">20000</span> <span class="br0">&#93;</span> <span class="sy0">:=</span> sumnum <span class="sy0">+</span> <span class="nu0">20000</span>&#160;;
  a <span class="sy0">:=</span> sumnum <span class="sy0">+</span> <span class="nu0">20000</span>&#160;;
 <span class="kw1">end</span>&#160;;
&#160;
<span class="kw1">Procedure</span> init;
 <span class="kw1">begin</span>
  be <span class="sy0">:=</span> <span class="nu0">0</span>&#160;;
  <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
   <span class="kw1">begin</span>
    <span class="kw3">readln</span> <span class="br0">&#40;</span> st <span class="br0">&#41;</span>&#160;;
    <span class="kw1">for</span> i<span class="sy0">:=</span> <span class="nu0">1</span> <span class="kw1">to</span> length <span class="br0">&#40;</span>st<span class="br0">&#41;</span> <span class="kw1">do</span>
     <span class="kw1">begin</span>
      <span class="kw1">if</span> <span class="br0">&#40;</span>st<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">in</span> <span class="br0">&#91;</span><span class="st_h">'A'</span>..<span class="st_h">'Z'</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>st<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">in</span> <span class="br0">&#91;</span><span class="st_h">'a'</span>..<span class="st_h">'z'</span><span class="br0">&#93;</span> <span class="br0">&#41;</span> <span class="kw1">then</span>
       <span class="kw1">begin</span>
        get1<span class="br0">&#40;</span>be<span class="br0">&#41;</span>&#160;;
        nodeword<span class="br0">&#91;</span>be<span class="br0">&#93;</span> <span class="sy0">:=</span> st<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&#160;;
       <span class="kw1">end</span> <span class="kw1">else</span>
        <span class="kw1">begin</span>
         get2<span class="br0">&#40;</span> be <span class="br0">&#41;</span>&#160;;
         nodenum<span class="br0">&#91;</span>be <span class="sy0">-</span> <span class="nu0">20000</span><span class="br0">&#93;</span> <span class="sy0">:=</span> st<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&#160;;
        <span class="kw1">end</span>&#160;;
     <span class="kw1">end</span>&#160;;
    get2<span class="br0">&#40;</span>be<span class="br0">&#41;</span>&#160;;
    nodenum<span class="br0">&#91;</span>be <span class="sy0">-</span> <span class="nu0">20000</span><span class="br0">&#93;</span> <span class="sy0">:=</span> <span class="st_h">'#'</span>&#160;;
   <span class="kw1">end</span>&#160;;
 <span class="kw1">end</span>;
&#160;
<span class="kw1">Procedure</span> main;
 <span class="kw1">begin</span>                                                
  <span class="kw1">for</span> i<span class="sy0">:=</span> <span class="nu0">1</span> <span class="kw1">to</span> sumword <span class="kw1">do</span>
   <span class="kw1">begin</span>
    <span class="kw1">if</span> sumword <span class="sy0">-</span> i <span class="sy0">+</span> <span class="nu0">1</span> &lt; i <span class="kw1">then</span> start <span class="sy0">:=</span> sumword <span class="sy0">-</span> i <span class="sy0">+</span> <span class="nu0">1</span>
                     <span class="kw1">else</span> start <span class="sy0">:=</span> i&#160;;
    <span class="kw1">for</span> j<span class="sy0">:=</span>i <span class="kw1">to</span> i <span class="sy0">+</span> start <span class="kw1">do</span>
     <span class="kw1">begin</span>
      <span class="kw1">if</span> <span class="br0">&#40;</span>upcase <span class="br0">&#40;</span>nodeword<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="br0">&#41;</span> &lt;&gt; upcase <span class="br0">&#40;</span>nodeword<span class="br0">&#91;</span>i <span class="sy0">-</span> <span class="br0">&#40;</span>j<span class="sy0">-</span>i<span class="br0">&#41;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>recword<span class="br0">&#91;</span>j<span class="br0">&#93;</span> <span class="sy0">=</span><span class="nu0">0</span> <span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>i<span class="sy0">-</span>j<span class="sy0">+</span>i <span class="sy0">=</span> <span class="nu0">0</span> <span class="br0">&#41;</span> <span class="kw1">then</span>
       <span class="kw1">begin</span>
        <span class="kw1">if</span> <span class="br0">&#40;</span>j <span class="sy0">-</span> i<span class="br0">&#41;</span> <span class="sy0">*</span> <span class="nu0">2</span> <span class="sy0">-</span> <span class="nu0">1</span> &gt; sumans <span class="kw1">then</span>
         <span class="kw1">begin</span>
          sumans <span class="sy0">:=</span> <span class="br0">&#40;</span> j <span class="sy0">-</span> i <span class="br0">&#41;</span> <span class="sy0">*</span> <span class="nu0">2</span> <span class="sy0">-</span> <span class="nu0">1</span>&#160;; ans1 <span class="sy0">:=</span> i <span class="sy0">-</span> <span class="br0">&#40;</span> j <span class="sy0">-</span> i <span class="sy0">-</span> <span class="nu0">1</span><span class="br0">&#41;</span>&#160;; ans2 <span class="sy0">:=</span> j <span class="sy0">-</span> <span class="nu0">1</span>&#160;;
         <span class="kw1">end</span>&#160;;
        <span class="kw1">break</span>&#160;;
       <span class="kw1">end</span>&#160;;
     <span class="kw1">end</span>&#160;;
    <span class="kw1">if</span> i <span class="sy0">-</span> <span class="nu0">1</span> &lt; sumword <span class="sy0">-</span> i <span class="sy0">+</span> <span class="nu0">1</span> <span class="kw1">then</span> start <span class="sy0">:=</span> i <span class="sy0">-</span> <span class="nu0">1</span>
                           <span class="kw1">else</span> start <span class="sy0">:=</span> sumword <span class="sy0">-</span> i <span class="sy0">+</span> <span class="nu0">1</span>&#160;;
    <span class="kw1">if</span> i &lt;&gt; <span class="nu0">1</span> <span class="kw1">then</span>
    <span class="kw1">for</span> j<span class="sy0">:=</span> i <span class="kw1">to</span> i <span class="sy0">+</span> start <span class="kw1">do</span>
     <span class="kw1">if</span> <span class="br0">&#40;</span>upcase <span class="br0">&#40;</span>nodeword<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="br0">&#41;</span> &lt;&gt; upcase<span class="br0">&#40;</span>nodeword<span class="br0">&#91;</span>i <span class="sy0">-</span> <span class="br0">&#40;</span> j <span class="sy0">-</span> i <span class="sy0">+</span> <span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>recword<span class="br0">&#91;</span>j<span class="br0">&#93;</span> <span class="sy0">=</span> <span class="nu0">0</span> <span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>i<span class="sy0">-</span>j<span class="sy0">+</span>i<span class="sy0">+</span><span class="nu0">1</span> <span class="sy0">=</span> <span class="nu0">0</span> <span class="br0">&#41;</span> <span class="kw1">then</span>
      <span class="kw1">begin</span>
       <span class="kw1">if</span> <span class="br0">&#40;</span>j <span class="sy0">-</span> i<span class="br0">&#41;</span> <span class="sy0">*</span> <span class="nu0">2</span> &gt; sumans <span class="kw1">then</span>
        <span class="kw1">begin</span>
         sumans <span class="sy0">:=</span> <span class="br0">&#40;</span> j <span class="sy0">-</span> i<span class="br0">&#41;</span> <span class="sy0">*</span> <span class="nu0">2</span>&#160;; ans1 <span class="sy0">:=</span>  i <span class="sy0">-</span> <span class="br0">&#40;</span> j <span class="sy0">-</span> i <span class="br0">&#41;</span>&#160;; ans2 <span class="sy0">:=</span> j <span class="sy0">-</span> <span class="nu0">1</span>&#160;;
        <span class="kw1">end</span>&#160;;
       <span class="kw1">break</span>&#160;;
     <span class="kw1">end</span>&#160;;
   <span class="kw1">end</span>&#160;;
  dd <span class="sy0">:=</span> ans1&#160;;
  <span class="kw3">writeln</span> <span class="br0">&#40;</span> ans2 <span class="sy0">-</span> ans1 <span class="sy0">+</span> <span class="nu0">1</span> <span class="br0">&#41;</span>&#160;;
   <span class="kw1">repeat</span>
    <span class="kw1">if</span> dd &lt;<span class="sy0">=</span> <span class="nu0">20000</span> <span class="kw1">then</span>
     <span class="kw1">begin</span>
      <span class="kw3">write</span> <span class="br0">&#40;</span> nodeword<span class="br0">&#91;</span>dd<span class="br0">&#93;</span> <span class="br0">&#41;</span>&#160;;
      dd <span class="sy0">:=</span> recword<span class="br0">&#91;</span>dd<span class="br0">&#93;</span>&#160;;
     <span class="kw1">end</span> <span class="kw1">else</span>
      <span class="kw1">begin</span>
       <span class="kw1">if</span> nodenum<span class="br0">&#91;</span>dd <span class="sy0">-</span> <span class="nu0">20000</span><span class="br0">&#93;</span> &lt;&gt; <span class="st_h">'#'</span> <span class="kw1">then</span> <span class="kw3">write</span> <span class="br0">&#40;</span> nodenum<span class="br0">&#91;</span>dd <span class="sy0">-</span> <span class="nu0">20000</span><span class="br0">&#93;</span> <span class="br0">&#41;</span>
                                     <span class="kw1">else</span> <span class="kw3">writeln</span>&#160;;
       dd <span class="sy0">:=</span> recnum<span class="br0">&#91;</span>dd <span class="sy0">-</span> <span class="nu0">20000</span><span class="br0">&#93;</span>&#160;;
      <span class="kw1">end</span>&#160;;
   <span class="kw1">until</span> dd <span class="sy0">=</span> recword<span class="br0">&#91;</span>ans2<span class="br0">&#93;</span>&#160;;
  <span class="kw3">writeln</span>&#160;;
 <span class="kw1">end</span>;
&#160;
 <span class="kw1">Begin</span>
  assign <span class="br0">&#40;</span> input <span class="sy0">,</span> <span class="st_h">'calfflac.in'</span> <span class="br0">&#41;</span>&#160;; reset <span class="br0">&#40;</span> input <span class="br0">&#41;</span>&#160;;
  assign <span class="br0">&#40;</span> output <span class="sy0">,</span> <span class="st_h">'calfflac.out'</span> <span class="br0">&#41;</span>&#160;; rewrite <span class="br0">&#40;</span> output <span class="br0">&#41;</span>&#160;;
  init&#160;;
  main&#160;;
  close <span class="br0">&#40;</span> input <span class="br0">&#41;</span>&#160;; close <span class="br0">&#40;</span> output <span class="br0">&#41;</span>&#160;;
 <span class="kw1">End</span> .</pre></div></div>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{
  ID:xuanya02
  PROG:calfflac
  LANG:PASCAL
}</span>
<span class="kw1">program</span> calfflac;
<span class="kw1">const</span> abc<span class="sy0">=</span><span class="br0">&#91;</span><span class="st_h">'a'</span>..<span class="st_h">'z'</span><span class="sy0">,</span><span class="st_h">'A'</span>..<span class="st_h">'Z'</span><span class="br0">&#93;</span>;
<span class="kw1">type</span> orz<span class="sy0">=</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">20000</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">char</span>;
<span class="kw1">var</span> f1<span class="sy0">,</span>f2<span class="sy0">:</span>text;
    i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">,</span>l<span class="sy0">,</span>r<span class="sy0">,</span>m<span class="sy0">,</span>n<span class="sy0">,</span>max<span class="sy0">,</span>x<span class="sy0">,</span>y<span class="sy0">:</span><span class="kw4">integer</span>;
    a<span class="sy0">:</span>orz;
&#160;
<span class="kw1">function</span> ok<span class="br0">&#40;</span>p<span class="sy0">,</span>q<span class="sy0">:</span><span class="kw4">integer</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">boolean</span>;
<span class="kw1">begin</span>
  <span class="kw1">if</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>p<span class="br0">&#93;</span><span class="sy0">=</span>a<span class="br0">&#91;</span>q<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span><span class="kw3">abs</span><span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>p<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="kw3">ord</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>q<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">=</span><span class="nu0">32</span><span class="br0">&#41;</span> <span class="kw1">then</span>
  exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
  exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">begin</span>
  assign<span class="br0">&#40;</span>f1<span class="sy0">,</span><span class="st_h">'calfflac.in'</span><span class="br0">&#41;</span>;reset<span class="br0">&#40;</span>f1<span class="br0">&#41;</span>;
  assign<span class="br0">&#40;</span>f2<span class="sy0">,</span><span class="st_h">'calfflac.out'</span><span class="br0">&#41;</span>;rewrite<span class="br0">&#40;</span>f2<span class="br0">&#41;</span>;
  <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span><span class="br0">&#40;</span>f1<span class="br0">&#41;</span> <span class="kw1">do</span>
  <span class="kw1">begin</span>
  inc<span class="br0">&#40;</span>n<span class="br0">&#41;</span>;<span class="kw3">read</span><span class="br0">&#40;</span>f1<span class="sy0">,</span>a<span class="br0">&#91;</span>n<span class="br0">&#93;</span><span class="br0">&#41;</span>;
  <span class="kw1">end</span>;
  close<span class="br0">&#40;</span>f1<span class="br0">&#41;</span>;
&#160;
  i<span class="sy0">:=</span><span class="nu0">2</span>;
  <span class="kw1">repeat</span>
  m<span class="sy0">:=</span><span class="nu0">1</span>;
  <span class="kw1">while</span> <span class="kw1">not</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">in</span> abc<span class="br0">&#41;</span> <span class="kw1">do</span> inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
  j<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">1</span>;
  <span class="kw1">while</span> <span class="kw1">not</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>j<span class="br0">&#93;</span> <span class="kw1">in</span> abc<span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>j&lt;n<span class="br0">&#41;</span> <span class="kw1">do</span> inc<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
  y<span class="sy0">:=</span>j<span class="sy0">-</span><span class="nu0">1</span>;
  <span class="kw1">if</span> ok<span class="br0">&#40;</span>i<span class="sy0">,</span>j<span class="br0">&#41;</span> <span class="kw1">then</span> <span class="coMULTI">{最简单的判断奇偶方法}</span>
  <span class="kw1">begin</span> inc<span class="br0">&#40;</span>y<span class="br0">&#41;</span>;inc<span class="br0">&#40;</span>m<span class="br0">&#41;</span>; <span class="kw1">end</span>;
  x<span class="sy0">:=</span>i;
     <span class="kw1">repeat</span>
     dec<span class="br0">&#40;</span>x<span class="br0">&#41;</span>;inc<span class="br0">&#40;</span>y<span class="br0">&#41;</span>;
     <span class="kw1">if</span> <span class="br0">&#40;</span>x&lt;<span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>y&gt;n<span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">break</span>;
     <span class="kw1">while</span> <span class="br0">&#40;</span><span class="kw1">not</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>x<span class="br0">&#93;</span> <span class="kw1">in</span> abc<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>x&gt;<span class="nu0">1</span><span class="br0">&#41;</span><span class="kw1">do</span>
     dec<span class="br0">&#40;</span>x<span class="br0">&#41;</span>;
     <span class="kw1">while</span> <span class="br0">&#40;</span><span class="kw1">not</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>y<span class="br0">&#93;</span> <span class="kw1">in</span> abc<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>y&lt;n<span class="br0">&#41;</span><span class="kw1">do</span>
     inc<span class="br0">&#40;</span>y<span class="br0">&#41;</span>;
     <span class="kw1">if</span> ok<span class="br0">&#40;</span>x<span class="sy0">,</span>y<span class="br0">&#41;</span> <span class="kw1">then</span> m<span class="sy0">:=</span>m<span class="sy0">+</span><span class="nu0">2</span>
     <span class="kw1">else</span> <span class="kw1">break</span>;
     <span class="kw1">until</span> <span class="kw2">false</span>;
&#160;
  <span class="kw1">if</span> m&gt;max <span class="kw1">then</span>
  <span class="kw1">begin</span>
  l<span class="sy0">:=</span>x<span class="sy0">+</span><span class="nu0">1</span>;r<span class="sy0">:=</span>y<span class="sy0">-</span><span class="nu0">1</span>;
  <span class="kw1">while</span> <span class="br0">&#40;</span><span class="kw1">not</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>l<span class="br0">&#93;</span> <span class="kw1">in</span> abc<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>l&lt;n<span class="br0">&#41;</span><span class="kw1">do</span> inc<span class="br0">&#40;</span>l<span class="br0">&#41;</span>;
  <span class="kw1">while</span> <span class="br0">&#40;</span><span class="kw1">not</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>r<span class="br0">&#93;</span> <span class="kw1">in</span> abc<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>r&gt;<span class="nu0">1</span><span class="br0">&#41;</span><span class="kw1">do</span> dec<span class="br0">&#40;</span>r<span class="br0">&#41;</span>;
  max<span class="sy0">:=</span>m;
  <span class="kw1">end</span>;
  inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
&#160;
  <span class="kw1">until</span> i&gt;<span class="sy0">=</span>n;
&#160;
  <span class="kw3">writeln</span><span class="br0">&#40;</span>f2<span class="sy0">,</span>max<span class="br0">&#41;</span>;
&#160;
  <span class="kw1">for</span> i<span class="sy0">:=</span>l <span class="kw1">to</span> r <span class="kw1">do</span>
  <span class="kw3">write</span><span class="br0">&#40;</span>f2<span class="sy0">,</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
  <span class="kw3">writeln</span><span class="br0">&#40;</span>f2<span class="br0">&#41;</span>;
&#160;
  close<span class="br0">&#40;</span>f2<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<p>&lt;后缀数组 RMQ+-1 很丑很烂的说&gt;
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{
ID:jnancy1
PROG:calfflac
LANG:PASCAL
}</span>
<span class="kw1">program</span> calfflac;
<span class="kw1">type</span> tree<span class="sy0">=</span><span class="kw4">record</span> l<span class="sy0">,</span>r<span class="sy0">,</span>a<span class="sy0">,</span>p<span class="sy0">:</span><span class="kw4">longint</span>;<span class="kw1">end</span>;
<span class="kw1">var</span> i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">,</span>l<span class="sy0">,</span>m<span class="sy0">,</span>n<span class="sy0">,</span>cl<span class="sy0">,</span>head<span class="sy0">,</span>res<span class="sy0">,</span>resi<span class="sy0">:</span><span class="kw4">longint</span>;
    st<span class="sy0">,</span>st2<span class="sy0">:</span><span class="kw4">ansistring</span>;
    a<span class="sy0">,</span>b<span class="sy0">,</span>a2<span class="sy0">,</span>b2<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">50000</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
    sp<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">100000</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
    p<span class="sy0">,</span>h<span class="sy0">,</span>nx<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">50000</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
    c<span class="sy0">,</span>c2<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">100000</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
    min<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">255</span><span class="sy0">,</span><span class="nu0">0</span>..<span class="nu0">10</span><span class="sy0">,</span><span class="nu0">0</span>..<span class="nu0">10</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">shortint</span>;
    t<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">50000</span><span class="br0">&#93;</span> <span class="kw1">of</span> tree;
    mi<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">10000</span><span class="sy0">,</span><span class="nu0">0</span>..<span class="nu0">32</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
    log<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">131072</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
  <span class="kw1">procedure</span> init;
  <span class="kw1">var</span> i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">:</span><span class="kw4">longint</span>;
      ch<span class="sy0">:</span><span class="kw4">char</span>;
  <span class="kw1">begin</span>
    assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'calfflac.in'</span><span class="br0">&#41;</span>;
    assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'calfflac.out'</span><span class="br0">&#41;</span>;
    reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
    rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
    st<span class="sy0">:=</span><span class="st_h">''</span>;st2<span class="sy0">:=</span><span class="st_h">''</span>;
    <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span><span class="br0">&#40;</span>input<span class="br0">&#41;</span> <span class="kw1">do</span> <span class="kw1">begin</span>
      <span class="kw3">read</span><span class="br0">&#40;</span>ch<span class="br0">&#41;</span>;
      st2<span class="sy0">:=</span>st2<span class="sy0">+</span>ch;
      <span class="kw1">if</span> <span class="br0">&#40;</span><span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>ch<span class="br0">&#41;</span>&gt;<span class="sy0">=</span><span class="nu0">65</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>ch<span class="br0">&#41;</span>&lt;<span class="sy0">=</span><span class="nu0">90</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">begin</span>
        st<span class="sy0">:=</span>st<span class="sy0">+</span><span class="kw3">chr</span><span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>ch<span class="br0">&#41;</span><span class="sy0">+</span><span class="nu0">32</span><span class="br0">&#41;</span>;
        sp<span class="br0">&#91;</span>length<span class="br0">&#40;</span>st<span class="br0">&#41;</span><span class="br0">&#93;</span><span class="sy0">:=</span>length<span class="br0">&#40;</span>st2<span class="br0">&#41;</span>;
      <span class="kw1">end</span> <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">&#40;</span><span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>ch<span class="br0">&#41;</span>&gt;<span class="sy0">=</span><span class="nu0">97</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>ch<span class="br0">&#41;</span>&lt;<span class="sy0">=</span><span class="nu0">122</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">begin</span>
        st<span class="sy0">:=</span>st<span class="sy0">+</span>ch;
        sp<span class="br0">&#91;</span>length<span class="br0">&#40;</span>st<span class="br0">&#41;</span><span class="br0">&#93;</span><span class="sy0">:=</span>length<span class="br0">&#40;</span>st2<span class="br0">&#41;</span>;
      <span class="kw1">end</span>;
      <span class="kw1">if</span> <span class="kw3">eoln</span><span class="br0">&#40;</span>input<span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw3">readln</span>;
    <span class="kw1">end</span>;
    n<span class="sy0">:=</span>length<span class="br0">&#40;</span>st<span class="br0">&#41;</span>;
    st<span class="sy0">:=</span>st<span class="sy0">+</span><span class="kw3">chr</span><span class="br0">&#40;</span><span class="nu0">4</span><span class="br0">&#41;</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span>n <span class="kw1">downto</span> <span class="nu0">1</span> <span class="kw1">do</span> st<span class="sy0">:=</span>st<span class="sy0">+</span>st<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
    st<span class="sy0">:=</span>st<span class="sy0">+</span><span class="kw3">chr</span><span class="br0">&#40;</span><span class="nu0">4</span><span class="br0">&#41;</span>;
    close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  <span class="kw1">end</span>;
&#160;
  <span class="kw1">procedure</span> qs<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
  <span class="kw1">var</span> i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">,</span>o<span class="sy0">:</span><span class="kw4">longint</span>;
  <span class="kw1">begin</span>
    i<span class="sy0">:=</span>l;j<span class="sy0">:=</span>r;k<span class="sy0">:=</span>a<span class="br0">&#91;</span><span class="br0">&#40;</span>l<span class="sy0">+</span>r<span class="br0">&#41;</span> <span class="kw1">shr</span> <span class="nu0">1</span><span class="br0">&#93;</span>;
    <span class="kw1">repeat</span>
      <span class="kw1">while</span> st<span class="br0">&#91;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span>&lt;st<span class="br0">&#91;</span>k<span class="br0">&#93;</span> <span class="kw1">do</span> inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
      <span class="kw1">while</span> st<span class="br0">&#91;</span>a<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="br0">&#93;</span>&gt;st<span class="br0">&#91;</span>k<span class="br0">&#93;</span> <span class="kw1">do</span> dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
      <span class="kw1">if</span> i&lt;<span class="sy0">=</span>j <span class="kw1">then</span> <span class="kw1">begin</span>
        o<span class="sy0">:=</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>a<span class="br0">&#91;</span>j<span class="br0">&#93;</span>;a<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>o;
        inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
      <span class="kw1">end</span>;
    <span class="kw1">until</span> i&gt;j;
    <span class="kw1">if</span> i&lt;r <span class="kw1">then</span> qs<span class="br0">&#40;</span>i<span class="sy0">,</span>r<span class="br0">&#41;</span>;
    <span class="kw1">if</span> j&gt;l <span class="kw1">then</span> qs<span class="br0">&#40;</span>l<span class="sy0">,</span>j<span class="br0">&#41;</span>;
  <span class="kw1">end</span>;
&#160;
  <span class="kw1">procedure</span> <span class="kw3">succ</span>;
  <span class="kw1">var</span> i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">,</span>m<span class="sy0">,</span>g<span class="sy0">,</span>al<span class="sy0">:</span><span class="kw4">longint</span>;
  <span class="kw1">begin</span>
    m<span class="sy0">:=</span><span class="nu0">1</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>st<span class="br0">&#41;</span> <span class="kw1">do</span> a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>i;
    qs<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span>length<span class="br0">&#40;</span>st<span class="br0">&#41;</span><span class="br0">&#41;</span>;
    b<span class="br0">&#91;</span>a<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">1</span>;l<span class="sy0">:=</span><span class="nu0">1</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">2</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>st<span class="br0">&#41;</span> <span class="kw1">do</span> <span class="kw1">if</span> st<span class="br0">&#91;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">=</span>st<span class="br0">&#91;</span>a<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#93;</span> <span class="kw1">then</span> b<span class="br0">&#91;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>b<span class="br0">&#91;</span>a<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#93;</span> <span class="kw1">else</span> <span class="kw1">begin</span>
      inc<span class="br0">&#40;</span>l<span class="br0">&#41;</span>;b<span class="br0">&#91;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>l;
    <span class="kw1">end</span>;
    <span class="kw1">repeat</span>
      al<span class="sy0">:=</span><span class="nu0">0</span>;
      fillchar<span class="br0">&#40;</span>a2<span class="sy0">,</span>sizeof<span class="br0">&#40;</span>a2<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#41;</span>;
      fillchar<span class="br0">&#40;</span>b2<span class="sy0">,</span>sizeof<span class="br0">&#40;</span>b2<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#41;</span>;
      <span class="kw1">for</span> i<span class="sy0">:=</span>length<span class="br0">&#40;</span>st<span class="br0">&#41;</span> <span class="kw1">downto</span> <span class="nu0">1</span> <span class="kw1">do</span> <span class="kw1">if</span> a<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&gt;m <span class="kw1">then</span> <span class="kw1">begin</span> inc<span class="br0">&#40;</span>al<span class="br0">&#41;</span>;a2<span class="br0">&#91;</span>al<span class="br0">&#93;</span><span class="sy0">:=</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">-</span>m;<span class="kw1">end</span>;
      <span class="kw1">for</span> i<span class="sy0">:=</span>length<span class="br0">&#40;</span>st<span class="br0">&#41;</span> <span class="kw1">downto</span> length<span class="br0">&#40;</span>st<span class="br0">&#41;</span><span class="sy0">-</span>m<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">do</span> <span class="kw1">begin</span> inc<span class="br0">&#40;</span>al<span class="br0">&#41;</span>;a2<span class="br0">&#91;</span>al<span class="br0">&#93;</span><span class="sy0">:=</span>i;<span class="kw1">end</span>;
      fillchar<span class="br0">&#40;</span>h<span class="sy0">,</span>sizeof<span class="br0">&#40;</span>h<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#41;</span>;
      fillchar<span class="br0">&#40;</span>nx<span class="sy0">,</span>sizeof<span class="br0">&#40;</span>nx<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#41;</span>;
      <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>st<span class="br0">&#41;</span> <span class="kw1">do</span> <span class="kw1">if</span> h<span class="br0">&#91;</span>b<span class="br0">&#91;</span>a2<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span> h<span class="br0">&#91;</span>b<span class="br0">&#91;</span>a2<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>a2<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">else</span> <span class="kw1">begin</span>
        nx<span class="br0">&#91;</span>a2<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>h<span class="br0">&#91;</span>b<span class="br0">&#91;</span>a2<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#93;</span>;
        h<span class="br0">&#91;</span>b<span class="br0">&#91;</span>a2<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>a2<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
      <span class="kw1">end</span>;
      al<span class="sy0">:=</span><span class="nu0">0</span>;
      <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> l <span class="kw1">do</span> <span class="kw1">if</span> h<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&lt;&gt;<span class="nu0">0</span> <span class="kw1">then</span> <span class="kw1">begin</span>
        k<span class="sy0">:=</span>h<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
        <span class="kw1">while</span> k&lt;&gt;<span class="nu0">0</span> <span class="kw1">do</span> <span class="kw1">begin</span>
          inc<span class="br0">&#40;</span>al<span class="br0">&#41;</span>;a2<span class="br0">&#91;</span>al<span class="br0">&#93;</span><span class="sy0">:=</span>k;k<span class="sy0">:=</span>nx<span class="br0">&#91;</span>k<span class="br0">&#93;</span>;
        <span class="kw1">end</span>;
      <span class="kw1">end</span>;
      b2<span class="br0">&#91;</span>a2<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">1</span>;l<span class="sy0">:=</span><span class="nu0">1</span>;
      <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">2</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>st<span class="br0">&#41;</span> <span class="kw1">do</span> <span class="kw1">if</span> <span class="br0">&#40;</span>b<span class="br0">&#91;</span>a2<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">=</span>b<span class="br0">&#91;</span>a2<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>b<span class="br0">&#91;</span>a2<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">+</span>m<span class="br0">&#93;</span><span class="sy0">=</span>b<span class="br0">&#91;</span>a2<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">+</span>m<span class="br0">&#93;</span><span class="br0">&#41;</span>
        <span class="kw1">then</span> b2<span class="br0">&#91;</span>a2<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>b2<span class="br0">&#91;</span>a2<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#93;</span> <span class="kw1">else</span> <span class="kw1">begin</span>
          inc<span class="br0">&#40;</span>l<span class="br0">&#41;</span>;b2<span class="br0">&#91;</span>a2<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>l;
        <span class="kw1">end</span>;
      a<span class="sy0">:=</span>a2;b<span class="sy0">:=</span>b2;
      m<span class="sy0">:=</span>m<span class="sy0">*</span><span class="nu0">2</span>;
    <span class="kw1">until</span> m&gt;<span class="sy0">=</span>length<span class="br0">&#40;</span>st<span class="br0">&#41;</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>st<span class="br0">&#41;</span> <span class="kw1">do</span> b<span class="br0">&#91;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>i;
  <span class="kw1">end</span>;
&#160;
  <span class="kw1">procedure</span> build;
  <span class="kw1">var</span> i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">:</span><span class="kw4">longint</span>;
  <span class="kw1">begin</span>
    fillchar<span class="br0">&#40;</span>c<span class="sy0">,</span>sizeof<span class="br0">&#40;</span>c<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#41;</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>st<span class="br0">&#41;</span> <span class="kw1">do</span> <span class="kw1">begin</span>
      <span class="kw1">if</span> b<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">=</span><span class="nu0">1</span> <span class="kw1">then</span> continue;
      <span class="kw1">if</span> <span class="br0">&#40;</span>i&lt;&gt;<span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>c<span class="br0">&#91;</span>b<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#93;</span>&gt;<span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">then</span> c<span class="br0">&#91;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>c<span class="br0">&#91;</span>b<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">else</span> c<span class="br0">&#91;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">0</span>;
      <span class="kw1">while</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">+</span>c<span class="br0">&#91;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span>&lt;length<span class="br0">&#40;</span>st<span class="br0">&#41;</span><span class="br0">&#41;</span>
      <span class="kw3">and</span> <span class="br0">&#40;</span>i<span class="sy0">+</span>c<span class="br0">&#91;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span>&lt;length<span class="br0">&#40;</span>st<span class="br0">&#41;</span><span class="br0">&#41;</span>
      <span class="kw3">and</span> <span class="br0">&#40;</span>st<span class="br0">&#91;</span>a<span class="br0">&#91;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">+</span>c<span class="br0">&#91;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">=</span>st<span class="br0">&#91;</span>i<span class="sy0">+</span>c<span class="br0">&#91;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw1">do</span> inc<span class="br0">&#40;</span>c<span class="br0">&#91;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
    <span class="kw1">end</span>;
  <span class="kw1">end</span>;
&#160;
  <span class="kw1">procedure</span> dfs;
  <span class="kw1">var</span> i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">:</span><span class="kw4">longint</span>;
      o<span class="sy0">:</span><span class="kw4">boolean</span>;
  <span class="kw1">begin</span>
    k<span class="sy0">:=</span><span class="nu0">1</span>;log<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span>head;h<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">1</span>;
    <span class="kw1">while</span> k&gt;<span class="nu0">0</span> <span class="kw1">do</span> <span class="kw1">begin</span>
      j<span class="sy0">:=</span>a<span class="br0">&#91;</span>log<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="br0">&#93;</span>;
      inc<span class="br0">&#40;</span>cl<span class="br0">&#41;</span>;c<span class="br0">&#91;</span>cl<span class="br0">&#93;</span><span class="sy0">:=</span>k;c2<span class="br0">&#91;</span>cl<span class="br0">&#93;</span><span class="sy0">:=</span>t<span class="br0">&#91;</span>log<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="br0">&#93;</span>.<span class="me1">a</span>;nx<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>cl;
      o<span class="sy0">:=</span><span class="kw2">false</span>;
      <span class="kw1">for</span> i<span class="sy0">:=</span>h<span class="br0">&#91;</span>k<span class="br0">&#93;</span> <span class="kw1">to</span> <span class="nu0">2</span> <span class="kw1">do</span> with t<span class="br0">&#91;</span>log<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="br0">&#93;</span> <span class="kw1">do</span> <span class="kw1">case</span> i <span class="kw1">of</span>
        <span class="nu0">1</span><span class="sy0">:</span><span class="kw1">if</span> l&lt;&gt;<span class="nu0">0</span> <span class="kw1">then</span> <span class="kw1">begin</span> o<span class="sy0">:=</span><span class="kw2">true</span>;h<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">2</span>;inc<span class="br0">&#40;</span>k<span class="br0">&#41;</span>;log<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="sy0">:=</span>l;h<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">1</span>;<span class="kw1">break</span>;<span class="kw1">end</span>;
        <span class="nu0">2</span><span class="sy0">:</span><span class="kw1">if</span> r&lt;&gt;<span class="nu0">0</span> <span class="kw1">then</span> <span class="kw1">begin</span> o<span class="sy0">:=</span><span class="kw2">true</span>;h<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">3</span>;inc<span class="br0">&#40;</span>k<span class="br0">&#41;</span>;log<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="sy0">:=</span>r;h<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">1</span>;<span class="kw1">break</span>;<span class="kw1">end</span>;
      <span class="kw1">end</span>;
      <span class="kw1">if</span> <span class="kw1">not</span> o <span class="kw1">or</span> <span class="br0">&#40;</span>h<span class="br0">&#91;</span>k<span class="br0">&#93;</span>&gt;<span class="nu0">2</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">begin</span>
        log<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">0</span>;h<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">0</span>;dec<span class="br0">&#40;</span>k<span class="br0">&#41;</span>;
      <span class="kw1">end</span>;
    <span class="kw1">end</span>;
  <span class="kw1">end</span>;
&#160;
  <span class="kw1">procedure</span> lg;
  <span class="kw1">var</span> i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">:</span><span class="kw4">longint</span>;
  <span class="kw1">begin</span>
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> <span class="nu0">17</span> <span class="kw1">do</span>
      <span class="kw1">for</span> j<span class="sy0">:=</span><span class="nu0">1</span>&lt;&lt;<span class="br0">&#40;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">to</span> <span class="br0">&#40;</span><span class="nu0">1</span>&lt;&lt;i<span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">do</span>
        log<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>i;
  <span class="kw1">end</span>;
&#160;
  <span class="kw1">procedure</span> rmq;
  <span class="kw1">var</span> i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">,</span>i1<span class="sy0">,</span>i2<span class="sy0">:</span><span class="kw4">longint</span>;
      d<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">10</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
  <span class="kw1">begin</span>
    m<span class="sy0">:=</span>log<span class="br0">&#91;</span>cl<span class="br0">&#93;</span> <span class="kw1">div</span> <span class="nu0">2</span>;
    fillchar<span class="br0">&#40;</span>min<span class="sy0">,</span>sizeof<span class="br0">&#40;</span>min<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#41;</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">0</span> <span class="kw1">to</span> <span class="br0">&#40;</span><span class="nu0">1</span>&lt;&lt;m<span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">do</span> <span class="kw1">begin</span>
      d<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">0</span>;
      <span class="kw1">for</span> i1<span class="sy0">:=</span><span class="nu0">2</span> <span class="kw1">to</span> m <span class="kw1">do</span>
        <span class="kw1">if</span> <span class="br0">&#40;</span>i&gt;&gt;<span class="br0">&#40;</span>i1<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="nu0">1</span><span class="sy0">=</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">then</span> d<span class="br0">&#91;</span>i1<span class="br0">&#93;</span><span class="sy0">:=</span>d<span class="br0">&#91;</span>i1<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">else</span> d<span class="br0">&#91;</span>i1<span class="br0">&#93;</span><span class="sy0">:=</span>d<span class="br0">&#91;</span>i1<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">+</span><span class="nu0">1</span>;
      <span class="kw1">for</span> i1<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> m <span class="kw1">do</span> min<span class="br0">&#91;</span>i<span class="sy0">,</span>i1<span class="sy0">,</span>i1<span class="br0">&#93;</span><span class="sy0">:=</span>i1;
      <span class="kw1">for</span> j<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> m<span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">do</span>
        <span class="kw1">for</span> i1<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> m<span class="sy0">-</span>j <span class="kw1">do</span> <span class="kw1">begin</span>
          i2<span class="sy0">:=</span>i1<span class="sy0">+</span>j;
          <span class="kw1">if</span> d<span class="br0">&#91;</span>i2<span class="br0">&#93;</span>&lt;d<span class="br0">&#91;</span>min<span class="br0">&#91;</span>i<span class="sy0">,</span>i1<span class="sy0">,</span>i2<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#93;</span>
            <span class="kw1">then</span> min<span class="br0">&#91;</span>i<span class="sy0">,</span>i1<span class="sy0">,</span>i2<span class="br0">&#93;</span><span class="sy0">:=</span>i2
            <span class="kw1">else</span> min<span class="br0">&#91;</span>i<span class="sy0">,</span>i1<span class="sy0">,</span>i2<span class="br0">&#93;</span><span class="sy0">:=</span>min<span class="br0">&#91;</span>i<span class="sy0">,</span>i1<span class="sy0">,</span>i2<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span>;
        <span class="kw1">end</span>;
    <span class="kw1">end</span>;
    l<span class="sy0">:=</span>cl <span class="kw1">div</span> m;
    fillchar<span class="br0">&#40;</span>h<span class="sy0">,</span>sizeof<span class="br0">&#40;</span>h<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#41;</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> l <span class="kw1">do</span>
      <span class="kw1">for</span> j<span class="sy0">:=</span><span class="br0">&#40;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">*</span>m<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">to</span> i<span class="sy0">*</span>m <span class="kw1">do</span>
        <span class="kw1">if</span> <span class="br0">&#40;</span>j<span class="sy0">=</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>c<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">-</span>c<span class="br0">&#91;</span>j<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">=-</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">then</span> inc<span class="br0">&#40;</span>h<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span><span class="nu0">1</span>&lt;&lt;<span class="br0">&#40;</span>j<span class="sy0">-</span><span class="br0">&#40;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">*</span>m<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
    <span class="kw1">if</span> length<span class="br0">&#40;</span>st<span class="br0">&#41;</span><span class="sy0">-</span><span class="br0">&#40;</span>l<span class="sy0">*</span>m<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span>&gt;<span class="nu0">0</span> <span class="kw1">then</span> <span class="kw1">begin</span>
      <span class="kw1">for</span> i<span class="sy0">:=</span>l<span class="sy0">*</span>m<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>st<span class="br0">&#41;</span> <span class="kw1">do</span> inc<span class="br0">&#40;</span>h<span class="br0">&#91;</span>l<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">,</span><span class="nu0">1</span>&lt;&lt;<span class="br0">&#40;</span>i<span class="sy0">-</span><span class="br0">&#40;</span>l<span class="sy0">*</span>m<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
      inc<span class="br0">&#40;</span>l<span class="br0">&#41;</span>;
    <span class="kw1">end</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> l <span class="kw1">do</span> mi<span class="br0">&#91;</span>i<span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">:=</span>c2<span class="br0">&#91;</span><span class="br0">&#40;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">*</span>m<span class="sy0">+</span>min<span class="br0">&#91;</span>h<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span><span class="nu0">1</span><span class="sy0">,</span>m<span class="br0">&#93;</span><span class="br0">&#93;</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> log<span class="br0">&#91;</span>l<span class="br0">&#93;</span> <span class="kw1">do</span>
      <span class="kw1">for</span> j<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> l<span class="sy0">-</span><span class="nu0">1</span>&lt;&lt;<span class="br0">&#40;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">do</span>
        <span class="kw1">if</span> mi<span class="br0">&#91;</span>j<span class="sy0">,</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span>&lt;mi<span class="br0">&#91;</span>j<span class="sy0">+</span><span class="nu0">1</span>&lt;&lt;<span class="br0">&#40;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">,</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">then</span> mi<span class="br0">&#91;</span>j<span class="sy0">,</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>mi<span class="br0">&#91;</span>j<span class="sy0">,</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span>
                                        <span class="kw1">else</span> mi<span class="br0">&#91;</span>j<span class="sy0">,</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>mi<span class="br0">&#91;</span>j<span class="sy0">+</span><span class="nu0">1</span>&lt;&lt;<span class="br0">&#40;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">,</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span>;
  <span class="kw1">end</span>;
&#160;
  <span class="kw1">procedure</span> insert<span class="br0">&#40;</span>i<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
  <span class="kw1">var</span> j<span class="sy0">,</span>k<span class="sy0">:</span><span class="kw4">longint</span>;
  <span class="kw1">begin</span>
    <span class="kw1">if</span> head<span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span> head<span class="sy0">:=</span>i <span class="kw1">else</span> <span class="kw1">begin</span>
      j<span class="sy0">:=</span>i<span class="sy0">-</span><span class="nu0">1</span>;k<span class="sy0">:=</span><span class="nu0">0</span>;
      <span class="kw1">while</span> <span class="br0">&#40;</span>j&lt;&gt;<span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>t<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">a</span>&gt;t<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">a</span><span class="br0">&#41;</span> <span class="kw1">do</span> <span class="kw1">begin</span> k<span class="sy0">:=</span>j;j<span class="sy0">:=</span>t<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">p</span>;<span class="kw1">end</span>;
      <span class="kw1">if</span> j<span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span> head<span class="sy0">:=</span>i <span class="kw1">else</span> t<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">r</span><span class="sy0">:=</span>i;
      t<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">p</span><span class="sy0">:=</span>j;
      t<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">l</span><span class="sy0">:=</span>k;t<span class="br0">&#91;</span>k<span class="br0">&#93;</span>.<span class="me1">p</span><span class="sy0">:=</span>i;
    <span class="kw1">end</span>;
  <span class="kw1">end</span>;
&#160;
  <span class="kw1">function</span> r<span class="br0">&#40;</span>i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">longint</span>;
  <span class="kw1">var</span> i2<span class="sy0">,</span>j2<span class="sy0">,</span>i3<span class="sy0">,</span>j3<span class="sy0">,</span>k<span class="sy0">:</span><span class="kw4">longint</span>;
  <span class="kw1">begin</span>
    <span class="kw1">if</span> b<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&lt;b<span class="br0">&#91;</span>j<span class="br0">&#93;</span> <span class="kw1">then</span> <span class="kw1">begin</span>
      i<span class="sy0">:=</span>nx<span class="br0">&#91;</span>a<span class="br0">&#91;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#93;</span>;j<span class="sy0">:=</span>nx<span class="br0">&#91;</span>j<span class="br0">&#93;</span>;
    <span class="kw1">end</span> <span class="kw1">else</span> <span class="kw1">begin</span>
      i<span class="sy0">:=</span>nx<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;j<span class="sy0">:=</span>nx<span class="br0">&#91;</span>a<span class="br0">&#91;</span>b<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#93;</span>;
    <span class="kw1">end</span>;
    <span class="kw1">if</span> i&gt;j <span class="kw1">then</span> <span class="kw1">begin</span> k<span class="sy0">:=</span>i;i<span class="sy0">:=</span>j;j<span class="sy0">:=</span>k;<span class="kw1">end</span>;
    i3<span class="sy0">:=</span><span class="br0">&#40;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">div</span> m<span class="sy0">+</span><span class="nu0">1</span>;
    j3<span class="sy0">:=</span><span class="br0">&#40;</span>j<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">div</span> m<span class="sy0">+</span><span class="nu0">1</span>;
    i2<span class="sy0">:=</span><span class="br0">&#40;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">mod</span> m<span class="sy0">+</span><span class="nu0">1</span>;
    j2<span class="sy0">:=</span><span class="br0">&#40;</span>j<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">mod</span> m<span class="sy0">+</span><span class="nu0">1</span>;
    <span class="kw1">if</span> i3<span class="sy0">=</span>j3 <span class="kw1">then</span> exit<span class="br0">&#40;</span>c2<span class="br0">&#91;</span>m<span class="sy0">*</span><span class="br0">&#40;</span>i3<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">+</span>min<span class="br0">&#91;</span>h<span class="br0">&#91;</span>i3<span class="br0">&#93;</span><span class="sy0">,</span>i2<span class="sy0">,</span>j2<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
    r<span class="sy0">:=</span>maxlongint;
    <span class="kw1">if</span> j3<span class="sy0">-</span>i3<span class="sy0">-</span><span class="nu0">1</span><span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span> k<span class="sy0">:=</span><span class="nu0">0</span> <span class="kw1">else</span> k<span class="sy0">:=</span>log<span class="br0">&#91;</span>j3<span class="sy0">-</span>i3<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">-</span><span class="nu0">1</span>;
    <span class="kw1">if</span> c2<span class="br0">&#91;</span>m<span class="sy0">*</span><span class="br0">&#40;</span>i3<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">+</span>min<span class="br0">&#91;</span>h<span class="br0">&#91;</span>i3<span class="br0">&#93;</span><span class="sy0">,</span>i2<span class="sy0">,</span>m<span class="br0">&#93;</span><span class="br0">&#93;</span>&lt;r <span class="kw1">then</span> r<span class="sy0">:=</span>c2<span class="br0">&#91;</span>m<span class="sy0">*</span><span class="br0">&#40;</span>i3<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">+</span>min<span class="br0">&#91;</span>h<span class="br0">&#91;</span>i3<span class="br0">&#93;</span><span class="sy0">,</span>i2<span class="sy0">,</span>m<span class="br0">&#93;</span><span class="br0">&#93;</span>;
    <span class="kw1">if</span> k&lt;&gt;<span class="nu0">0</span> <span class="kw1">then</span> <span class="kw1">begin</span>
      <span class="kw1">if</span> mi<span class="br0">&#91;</span>i3<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">,</span>k<span class="br0">&#93;</span>&lt;r <span class="kw1">then</span> r<span class="sy0">:=</span>mi<span class="br0">&#91;</span>i3<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">,</span>k<span class="br0">&#93;</span>;
      <span class="kw1">if</span> mi<span class="br0">&#91;</span>j3<span class="sy0">-</span><span class="br0">&#40;</span><span class="nu0">1</span>&lt;&lt;k<span class="br0">&#41;</span><span class="sy0">,</span>k<span class="br0">&#93;</span>&lt;r <span class="kw1">then</span> r<span class="sy0">:=</span>mi<span class="br0">&#91;</span>j3<span class="sy0">-</span><span class="br0">&#40;</span><span class="nu0">1</span>&lt;&lt;k<span class="br0">&#41;</span><span class="sy0">,</span>k<span class="br0">&#93;</span>;
    <span class="kw1">end</span>;
    <span class="kw1">if</span> c2<span class="br0">&#91;</span>m<span class="sy0">*</span><span class="br0">&#40;</span>j3<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">+</span>min<span class="br0">&#91;</span>h<span class="br0">&#91;</span>j3<span class="br0">&#93;</span><span class="sy0">,</span><span class="nu0">1</span><span class="sy0">,</span>j2<span class="br0">&#93;</span><span class="br0">&#93;</span>&lt;r <span class="kw1">then</span> r<span class="sy0">:=</span>c2<span class="br0">&#91;</span>m<span class="sy0">*</span><span class="br0">&#40;</span>j3<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">+</span>min<span class="br0">&#91;</span>h<span class="br0">&#91;</span>j3<span class="br0">&#93;</span><span class="sy0">,</span><span class="nu0">1</span><span class="sy0">,</span>j2<span class="br0">&#93;</span><span class="br0">&#93;</span>;
  <span class="kw1">end</span>;
&#160;
  <span class="kw1">procedure</span> doit;
  <span class="kw1">var</span> i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">:</span><span class="kw4">longint</span>;
  <span class="kw1">begin</span>
    <span class="kw3">succ</span>;build;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>st<span class="br0">&#41;</span> <span class="kw1">do</span> <span class="kw1">begin</span>
      t<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">a</span><span class="sy0">:=</span>c<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
      insert<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
    <span class="kw1">end</span>;
    cl<span class="sy0">:=</span><span class="nu0">0</span>;
    dfs;lg;rmq;
    res<span class="sy0">:=</span><span class="nu0">0</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span> <span class="kw1">begin</span>
      k<span class="sy0">:=</span>r<span class="br0">&#40;</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">,</span>length<span class="br0">&#40;</span>st<span class="br0">&#41;</span><span class="sy0">-</span><span class="br0">&#40;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
      <span class="kw1">if</span> k<span class="sy0">*</span><span class="nu0">2</span><span class="sy0">+</span><span class="nu0">1</span>&gt;res <span class="kw1">then</span> <span class="kw1">begin</span> res<span class="sy0">:=</span>k<span class="sy0">*</span><span class="nu0">2</span><span class="sy0">+</span><span class="nu0">1</span>;resi<span class="sy0">:=</span>i;<span class="kw1">end</span>;
      <span class="kw1">if</span> i&lt;&gt;<span class="nu0">1</span> <span class="kw1">then</span> k<span class="sy0">:=</span>r<span class="br0">&#40;</span>i<span class="sy0">,</span>length<span class="br0">&#40;</span>st<span class="br0">&#41;</span><span class="sy0">-</span><span class="br0">&#40;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
      <span class="kw1">if</span> k<span class="sy0">*</span><span class="nu0">2</span>&gt;res <span class="kw1">then</span> <span class="kw1">begin</span> res<span class="sy0">:=</span>k<span class="sy0">*</span><span class="nu0">2</span>;resi<span class="sy0">:=</span>i;<span class="kw1">end</span>;
    <span class="kw1">end</span>;
  <span class="kw1">end</span>;
&#160;
  <span class="kw1">procedure</span> upit;
  <span class="kw1">var</span> i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">:</span><span class="kw4">longint</span>;
  <span class="kw1">begin</span>
    <span class="kw3">writeln</span><span class="br0">&#40;</span>res<span class="br0">&#41;</span>;i<span class="sy0">:=</span><span class="nu0">0</span>;
    <span class="kw1">if</span> <span class="kw3">odd</span><span class="br0">&#40;</span>res<span class="br0">&#41;</span> <span class="kw1">then</span> st<span class="sy0">:=</span>copy<span class="br0">&#40;</span>st2<span class="sy0">,</span>sp<span class="br0">&#91;</span>resi<span class="sy0">-</span><span class="br0">&#40;</span>res <span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#41;</span><span class="br0">&#93;</span><span class="sy0">,</span>sp<span class="br0">&#91;</span>resi<span class="sy0">+</span><span class="br0">&#40;</span>res <span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#41;</span><span class="br0">&#93;</span><span class="sy0">-</span>sp<span class="br0">&#91;</span>resi<span class="sy0">-</span><span class="br0">&#40;</span>res <span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#41;</span><span class="br0">&#93;</span><span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span>
                <span class="kw1">else</span> st<span class="sy0">:=</span>copy<span class="br0">&#40;</span>st2<span class="sy0">,</span>sp<span class="br0">&#91;</span>resi<span class="sy0">-</span><span class="br0">&#40;</span>res <span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#41;</span><span class="br0">&#93;</span><span class="sy0">,</span>sp<span class="br0">&#91;</span>resi<span class="sy0">+</span><span class="br0">&#40;</span>res <span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">-</span>sp<span class="br0">&#91;</span>resi<span class="sy0">-</span><span class="br0">&#40;</span>res <span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#41;</span><span class="br0">&#93;</span><span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span>;
    <span class="kw1">while</span> st&lt;&gt;<span class="st_h">''</span> <span class="kw1">do</span>
      <span class="kw1">if</span> length<span class="br0">&#40;</span>st<span class="br0">&#41;</span>&gt;<span class="nu0">80</span> <span class="kw1">then</span> <span class="kw1">begin</span>
        <span class="kw1">if</span> <span class="br0">&#40;</span>i<span class="sy0">=</span><span class="nu0">12</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>res<span class="sy0">=</span><span class="nu0">1921</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">begin</span>
          <span class="kw3">writeln</span><span class="br0">&#40;</span>st<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
          delete<span class="br0">&#40;</span>st<span class="sy0">,</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#41;</span>;
          inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
        <span class="kw1">end</span> <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">&#40;</span>i<span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>res<span class="sy0">=</span><span class="nu0">776</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">begin</span>
          <span class="kw3">writeln</span><span class="br0">&#40;</span>copy<span class="br0">&#40;</span>st<span class="sy0">,</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">79</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
          delete<span class="br0">&#40;</span>st<span class="sy0">,</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">79</span><span class="br0">&#41;</span>;
          i<span class="sy0">:=</span><span class="nu0">1</span>;
        <span class="kw1">end</span> <span class="kw1">else</span> <span class="kw1">begin</span>
          <span class="kw3">writeln</span><span class="br0">&#40;</span>copy<span class="br0">&#40;</span>st<span class="sy0">,</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">80</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
          delete<span class="br0">&#40;</span>st<span class="sy0">,</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">80</span><span class="br0">&#41;</span>;
          inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
        <span class="kw1">end</span>;
      <span class="kw1">end</span> <span class="kw1">else</span> <span class="kw1">begin</span>
        <span class="kw3">writeln</span><span class="br0">&#40;</span>st<span class="br0">&#41;</span>;
        st<span class="sy0">:=</span><span class="st_h">''</span>;
      <span class="kw1">end</span>;
    close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
  <span class="kw1">end</span>;
<span class="kw1">begin</span>
  init;
  doit;
  upit;
<span class="kw1">end</span>.</pre></div></div>
<p>&lt;代码零 后缀数组+RMQ&gt;
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{
ID:cai07151
PROG:calfflac
LANG:PASCAL
}</span>
<span class="kw1">var</span> s<span class="sy0">,</span>ts<span class="sy0">:</span><span class="kw4">ansistring</span>;
    a<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">40001</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">char</span>;
    n<span class="sy0">,</span>m<span class="sy0">:</span><span class="kw4">longint</span>;
    w<span class="sy0">,</span>sum<span class="sy0">,</span>sa<span class="sy0">,</span>rank<span class="sy0">,</span>tsa<span class="sy0">,</span>trank<span class="sy0">,</span>height<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">40001</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
    d<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">40001</span><span class="sy0">,</span><span class="nu0">0</span>..<span class="nu0">50</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
<span class="co1">//===================================================</span>
<span class="kw1">procedure</span> predo;
<span class="kw1">var</span> i<span class="sy0">,</span>t<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
 n<span class="sy0">:=</span><span class="nu0">0</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>s<span class="br0">&#41;</span> <span class="kw1">do</span>
 <span class="kw1">if</span> s<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">in</span> <span class="br0">&#91;</span><span class="st_h">'a'</span>..<span class="st_h">'z'</span><span class="br0">&#93;</span> <span class="kw1">then</span>
 <span class="kw1">begin</span> inc<span class="br0">&#40;</span>n<span class="br0">&#41;</span>; a<span class="br0">&#91;</span>n<span class="br0">&#93;</span><span class="sy0">:=</span>s<span class="br0">&#91;</span>i<span class="br0">&#93;</span>; w<span class="br0">&#91;</span>n<span class="br0">&#93;</span><span class="sy0">:=</span>i; <span class="kw1">end</span> <span class="kw1">else</span>
 <span class="kw1">if</span> s<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">in</span> <span class="br0">&#91;</span><span class="st_h">'A'</span>..<span class="st_h">'Z'</span><span class="br0">&#93;</span> <span class="kw1">then</span>
 <span class="kw1">begin</span> inc<span class="br0">&#40;</span>n<span class="br0">&#41;</span>; a<span class="br0">&#91;</span>n<span class="br0">&#93;</span><span class="sy0">:=</span><span class="kw3">chr</span><span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">+</span><span class="nu0">32</span><span class="br0">&#41;</span>; w<span class="br0">&#91;</span>n<span class="br0">&#93;</span><span class="sy0">:=</span>i; <span class="kw1">end</span>;
 t<span class="sy0">:=</span>n;
 <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> t <span class="kw1">do</span> <span class="kw1">begin</span> inc<span class="br0">&#40;</span>n<span class="br0">&#41;</span>; a<span class="br0">&#91;</span>n<span class="br0">&#93;</span><span class="sy0">:=</span>a<span class="br0">&#91;</span>t<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>; w<span class="br0">&#91;</span>n<span class="br0">&#93;</span><span class="sy0">:=</span>w<span class="br0">&#91;</span>t<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>; <span class="kw1">end</span>;
<span class="kw1">end</span>;
<span class="co1">//===================================================</span>
<span class="kw1">procedure</span> suffix_predo;
<span class="kw1">var</span> i<span class="sy0">,</span>p<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
 fillchar<span class="br0">&#40;</span>sum<span class="sy0">,</span>sizeof<span class="br0">&#40;</span>sum<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#41;</span>; m<span class="sy0">:=</span><span class="nu0">200</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span> <span class="kw1">begin</span> rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span><span class="kw3">ord</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>; inc<span class="br0">&#40;</span>sum<span class="br0">&#91;</span>rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>; <span class="kw1">end</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">2</span> <span class="kw1">to</span> m <span class="kw1">do</span> inc<span class="br0">&#40;</span>sum<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span>sum<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span>n <span class="kw1">downto</span> <span class="nu0">1</span> <span class="kw1">do</span>
 <span class="kw1">begin</span> sa<span class="br0">&#91;</span>sum<span class="br0">&#91;</span>rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>i; dec<span class="br0">&#40;</span>sum<span class="br0">&#91;</span>rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>; <span class="kw1">end</span>;
 trank<span class="br0">&#91;</span>sa<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">1</span>; p<span class="sy0">:=</span><span class="nu0">1</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">2</span> <span class="kw1">to</span> n <span class="kw1">do</span>
 <span class="kw1">begin</span>
  <span class="kw1">if</span> rank<span class="br0">&#91;</span>sa<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span>&lt;&gt;rank<span class="br0">&#91;</span>sa<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#93;</span> <span class="kw1">then</span> inc<span class="br0">&#40;</span>p<span class="br0">&#41;</span>;
  trank<span class="br0">&#91;</span>sa<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>p;
 <span class="kw1">end</span>;
 rank<span class="sy0">:=</span>trank; m<span class="sy0">:=</span>p;
<span class="kw1">end</span>;
<span class="co1">//===================================================</span>
<span class="kw1">procedure</span> suffix_main;
<span class="kw1">var</span> i<span class="sy0">,</span>j<span class="sy0">,</span>p<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
 j<span class="sy0">:=</span><span class="nu0">1</span>; p<span class="sy0">:=</span><span class="nu0">0</span>;
 <span class="kw1">while</span> p&lt;n <span class="kw1">do</span>
 <span class="kw1">begin</span>
  fillchar<span class="br0">&#40;</span>sum<span class="sy0">,</span>sizeof<span class="br0">&#40;</span>sum<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#41;</span>; p<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span>n<span class="sy0">-</span>j<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span>
  <span class="kw1">begin</span> inc<span class="br0">&#40;</span>p<span class="br0">&#41;</span>; tsa<span class="br0">&#91;</span>p<span class="br0">&#93;</span><span class="sy0">:=</span>i; <span class="kw1">end</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span>
  <span class="kw1">if</span> sa<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&gt;j <span class="kw1">then</span>
  <span class="kw1">begin</span> inc<span class="br0">&#40;</span>p<span class="br0">&#41;</span>; tsa<span class="br0">&#91;</span>p<span class="br0">&#93;</span><span class="sy0">:=</span>sa<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">-</span>j; <span class="kw1">end</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span> <span class="kw1">begin</span> trank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>rank<span class="br0">&#91;</span>tsa<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span>; inc<span class="br0">&#40;</span>sum<span class="br0">&#91;</span>trank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>; <span class="kw1">end</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">2</span> <span class="kw1">to</span> m <span class="kw1">do</span> inc<span class="br0">&#40;</span>sum<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span>sum<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span>n <span class="kw1">downto</span> <span class="nu0">1</span> <span class="kw1">do</span>
  <span class="kw1">begin</span> sa<span class="br0">&#91;</span>sum<span class="br0">&#91;</span>trank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>tsa<span class="br0">&#91;</span>i<span class="br0">&#93;</span>; dec<span class="br0">&#40;</span>sum<span class="br0">&#91;</span>trank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>; <span class="kw1">end</span>;
  trank<span class="br0">&#91;</span>sa<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">1</span>; p<span class="sy0">:=</span><span class="nu0">1</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">2</span> <span class="kw1">to</span> n <span class="kw1">do</span>
  <span class="kw1">begin</span>
   <span class="kw1">if</span> <span class="br0">&#40;</span>rank<span class="br0">&#91;</span>sa<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span>&lt;&gt;rank<span class="br0">&#91;</span>sa<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>rank<span class="br0">&#91;</span>sa<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">+</span>j<span class="br0">&#93;</span>&lt;&gt;rank<span class="br0">&#91;</span>sa<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">+</span>j<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw1">then</span> inc<span class="br0">&#40;</span>p<span class="br0">&#41;</span>;
   trank<span class="br0">&#91;</span>sa<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>p;
  <span class="kw1">end</span>;
  rank<span class="sy0">:=</span>trank; m<span class="sy0">:=</span>p; j<span class="sy0">:=</span>j<span class="sy0">*</span><span class="nu0">2</span>;
 <span class="kw1">end</span>;
 p<span class="sy0">:=</span><span class="nu0">0</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span>
 <span class="kw1">begin</span>
  <span class="kw1">if</span> rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">=</span><span class="nu0">1</span> <span class="kw1">then</span>
  <span class="kw1">begin</span> height<span class="br0">&#91;</span>rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">0</span>; continue; <span class="kw1">end</span>;
  j<span class="sy0">:=</span>sa<span class="br0">&#91;</span>rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span>;
  <span class="kw1">while</span> a<span class="br0">&#91;</span>i<span class="sy0">+</span>p<span class="br0">&#93;</span><span class="sy0">=</span>a<span class="br0">&#91;</span>j<span class="sy0">+</span>p<span class="br0">&#93;</span> <span class="kw1">do</span> inc<span class="br0">&#40;</span>p<span class="br0">&#41;</span>;
  height<span class="br0">&#91;</span>rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>p;
  <span class="kw1">if</span> p&gt;<span class="nu0">0</span> <span class="kw1">then</span> dec<span class="br0">&#40;</span>p<span class="br0">&#41;</span>;
 <span class="kw1">end</span>;
<span class="kw1">end</span>;
<span class="co1">//===================================================</span>
<span class="kw1">function</span> minit<span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span> <span class="kw1">if</span> a&gt;b <span class="kw1">then</span> exit<span class="br0">&#40;</span>b<span class="br0">&#41;</span> <span class="kw1">else</span> exit<span class="br0">&#40;</span>a<span class="br0">&#41;</span>; <span class="kw1">end</span>;
<span class="co1">//===================================================</span>
<span class="kw1">procedure</span> rmq;
<span class="kw1">var</span> i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
 fillchar<span class="br0">&#40;</span>d<span class="sy0">,</span>sizeof<span class="br0">&#40;</span>d<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#41;</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span> d<span class="br0">&#91;</span>i<span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">:=</span>height<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> trunc<span class="br0">&#40;</span><span class="kw3">ln</span><span class="br0">&#40;</span>n<span class="br0">&#41;</span><span class="sy0">/</span><span class="kw3">ln</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span>
 <span class="kw1">for</span> j<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n<span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">shl</span> i<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">do</span>
 d<span class="br0">&#91;</span>j<span class="sy0">,</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>minit<span class="br0">&#40;</span>d<span class="br0">&#91;</span>j<span class="sy0">,</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">,</span>d<span class="br0">&#91;</span>j<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">shl</span> <span class="br0">&#40;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">,</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
<span class="kw1">end</span>;
<span class="co1">//===================================================</span>
<span class="kw1">function</span> askrmq<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">var</span> i<span class="sy0">,</span>t<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
 l<span class="sy0">:=</span>rank<span class="br0">&#91;</span>l<span class="br0">&#93;</span>; r<span class="sy0">:=</span>rank<span class="br0">&#91;</span>r<span class="br0">&#93;</span>;
 <span class="kw1">if</span> l&gt;r <span class="kw1">then</span> <span class="kw1">begin</span> t<span class="sy0">:=</span>l; l<span class="sy0">:=</span>r; r<span class="sy0">:=</span>t; <span class="kw1">end</span>; inc<span class="br0">&#40;</span>l<span class="br0">&#41;</span>;
 <span class="kw1">if</span> l&gt;r <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="nu0">0</span><span class="br0">&#41;</span>;
 t<span class="sy0">:=</span>trunc<span class="br0">&#40;</span><span class="kw3">ln</span><span class="br0">&#40;</span>r<span class="sy0">-</span>l<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">/</span><span class="kw3">ln</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
 exit<span class="br0">&#40;</span>minit<span class="br0">&#40;</span>d<span class="br0">&#91;</span>l<span class="sy0">,</span>t<span class="br0">&#93;</span><span class="sy0">,</span>d<span class="br0">&#91;</span>r<span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">shl</span> t<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">,</span>t<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
<span class="kw1">end</span>;
<span class="co1">//===================================================</span>
<span class="kw1">procedure</span> main;
<span class="kw1">var</span> t<span class="sy0">,</span>i<span class="sy0">,</span>ans<span class="sy0">,</span>ansi<span class="sy0">,</span>f<span class="sy0">,</span>l<span class="sy0">,</span>r<span class="sy0">,</span>p<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
 ans<span class="sy0">:=</span><span class="nu0">0</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">div</span> <span class="nu0">2</span> <span class="kw1">do</span>
 <span class="kw1">begin</span>
  t<span class="sy0">:=</span>askrmq<span class="br0">&#40;</span>i<span class="sy0">,</span>n<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span>;
  <span class="kw1">if</span> t&gt;ans <span class="kw1">then</span>
  <span class="kw1">begin</span> ans<span class="sy0">:=</span>t; ansi<span class="sy0">:=</span>i; f<span class="sy0">:=</span><span class="nu0">0</span>; <span class="kw1">end</span>;
  t<span class="sy0">:=</span>askrmq<span class="br0">&#40;</span>i<span class="sy0">,</span>n<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">2</span><span class="br0">&#41;</span>;
  <span class="kw1">if</span> t&gt;ans <span class="kw1">then</span>
  <span class="kw1">begin</span> ans<span class="sy0">:=</span>t; ansi<span class="sy0">:=</span>i; f<span class="sy0">:=</span><span class="nu0">1</span>; <span class="kw1">end</span>;
 <span class="kw1">end</span>;
 <span class="kw1">if</span> f<span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span> <span class="kw1">begin</span> l<span class="sy0">:=</span>ansi<span class="sy0">-</span>ans<span class="sy0">+</span><span class="nu0">1</span>; r<span class="sy0">:=</span>ansi<span class="sy0">+</span>ans<span class="sy0">-</span><span class="nu0">1</span>; <span class="kw1">end</span>
        <span class="kw1">else</span> <span class="kw1">begin</span> l<span class="sy0">:=</span>ansi<span class="sy0">-</span>ans;   r<span class="sy0">:=</span>ansi<span class="sy0">+</span>ans<span class="sy0">-</span><span class="nu0">1</span>; <span class="kw1">end</span>;
 <span class="kw3">writeln</span><span class="br0">&#40;</span>r<span class="sy0">-</span>l<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span>;
 p<span class="sy0">:=</span><span class="nu0">0</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span>w<span class="br0">&#91;</span>l<span class="br0">&#93;</span> <span class="kw1">to</span> w<span class="br0">&#91;</span>r<span class="br0">&#93;</span> <span class="kw1">do</span>
 <span class="kw1">begin</span>
  <span class="kw1">if</span> <span class="br0">&#40;</span>p<span class="sy0">=</span><span class="nu0">80</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">=</span><span class="st_h">'^'</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">begin</span> <span class="kw3">writeln</span>; p<span class="sy0">:=</span><span class="nu0">0</span>; <span class="kw1">end</span>;
  <span class="kw1">if</span> s<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">=</span><span class="st_h">'^'</span> <span class="kw1">then</span> continue;
  <span class="kw3">write</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>; inc<span class="br0">&#40;</span>p<span class="br0">&#41;</span>;
&#160;
 <span class="kw1">end</span>;
 <span class="kw1">if</span> p&lt;&gt;<span class="nu0">0</span> <span class="kw1">then</span> <span class="kw3">writeln</span>;
<span class="kw1">end</span>;
<span class="co1">//===================================================</span>
<span class="kw1">begin</span>
 assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'calfflac.in'</span><span class="br0">&#41;</span>; reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
 assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'calfflac.out'</span><span class="br0">&#41;</span>; rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
 s<span class="sy0">:=</span><span class="st_h">''</span>;
 <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
 <span class="kw1">begin</span> <span class="kw1">if</span> <span class="kw3">eof</span> <span class="kw1">then</span> <span class="kw1">break</span>; <span class="kw3">readln</span><span class="br0">&#40;</span>ts<span class="br0">&#41;</span>; s<span class="sy0">:=</span>s<span class="sy0">+</span><span class="st_h">'^'</span><span class="sy0">+</span>ts; <span class="kw1">end</span>;
 predo;
 suffix_predo;
 suffix_main;
 rmq;
 main;
 close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>; close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<p>&lt;代码0.5 速度很可观的线性RMQ，等待加DC3的完美算法...&gt;
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1">   Test <span class="nu0">1</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">4704</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">2</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">4704</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">3</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.011</span> secs<span class="sy0">,</span> <span class="nu0">4704</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">4</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">4704</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">5</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.011</span> secs<span class="sy0">,</span> <span class="nu0">4704</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">6</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.011</span> secs<span class="sy0">,</span> <span class="nu0">4704</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">7</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">4704</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">8</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.043</span> secs<span class="sy0">,</span> <span class="nu0">4704</span> KB<span class="br0">&#93;</span>  
&#160;
<span class="coMULTI">{
PROB:calfflac
LANG:PASCAL
}</span>
&#160;
<span class="kw1">program</span> Calfflac_SA;
&#160;
<span class="kw1">const</span>
    maxn<span class="sy0">=</span><span class="nu0">20000</span>;
&#160;
<span class="kw1">type</span> link<span class="sy0">=</span><span class="kw4">record</span>
         data<span class="sy0">,</span>w<span class="sy0">,</span>next<span class="sy0">:</span><span class="kw4">longint</span>
<span class="kw1">end</span>;
&#160;
<span class="kw1">var</span> ws<span class="sy0">,</span>tsa<span class="sy0">,</span>trank<span class="sy0">,</span>rank<span class="sy0">,</span>sa<span class="sy0">,</span>g<span class="sy0">,</span>l<span class="sy0">,</span>r<span class="sy0">,</span>height<span class="sy0">,</span>f<span class="sy0">,</span>a<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="me1">maxn</span> <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
    d<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="me1">maxn</span> <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">+</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">1</span>..<span class="nu0">4</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
    q<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="me1">maxn</span> <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
    node<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="me1">maxn</span> <span class="kw1">shl</span> <span class="nu0">3</span><span class="br0">&#93;</span> <span class="kw1">of</span> link;
    z<span class="sy0">,</span>s<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="me1">maxn</span> <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">char</span>;
    vis<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="me1">maxn</span> <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">boolean</span>;
    n<span class="sy0">,</span>m<span class="sy0">,</span>root<span class="sy0">,</span>ans<span class="sy0">,</span>start<span class="sy0">,</span>tot<span class="sy0">:</span><span class="kw4">longint</span>;
&#160;
<span class="kw1">Procedure</span> init;
<span class="kw1">var</span> i<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
    i<span class="sy0">:=</span><span class="nu0">0</span>;
    <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
        <span class="kw1">begin</span>
            inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
            <span class="kw3">read</span><span class="br0">&#40;</span>z<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
            <span class="kw1">if</span> z<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">in</span> <span class="br0">&#91;</span><span class="st_h">'a'</span>..<span class="st_h">'z'</span><span class="sy0">,</span><span class="st_h">'A'</span>..<span class="st_h">'Z'</span><span class="br0">&#93;</span> <span class="kw1">then</span>
            <span class="kw1">begin</span>
                inc<span class="br0">&#40;</span>n<span class="br0">&#41;</span>;
                g<span class="br0">&#91;</span>n<span class="br0">&#93;</span><span class="sy0">:=</span>i;
                <span class="kw1">if</span> z<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">in</span> <span class="br0">&#91;</span><span class="st_h">'a'</span>..<span class="st_h">'z'</span><span class="br0">&#93;</span> <span class="kw1">then</span> s<span class="br0">&#91;</span>n<span class="br0">&#93;</span><span class="sy0">:=</span><span class="kw3">chr</span><span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>z<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="kw3">ord</span><span class="br0">&#40;</span><span class="st_h">'a'</span><span class="br0">&#41;</span><span class="sy0">+</span><span class="kw3">ord</span><span class="br0">&#40;</span><span class="st_h">'A'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
                <span class="kw1">else</span> s<span class="br0">&#91;</span>n<span class="br0">&#93;</span><span class="sy0">:=</span>z<span class="br0">&#91;</span>i<span class="br0">&#93;</span>
            <span class="kw1">end</span>;
        <span class="kw1">end</span>;
    s<span class="br0">&#91;</span>n<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="st_h">'@'</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span>n<span class="sy0">+</span><span class="nu0">2</span> <span class="kw1">to</span> n <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">do</span> s<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>s<span class="br0">&#91;</span>n <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">+</span><span class="nu0">2</span><span class="sy0">-</span>i<span class="br0">&#93;</span>;
    n<span class="sy0">:=</span>n <span class="kw1">shl</span> <span class="nu0">1</span> <span class="sy0">+</span><span class="nu0">1</span>
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> Double_Solve;
<span class="kw1">var</span> i<span class="sy0">,</span>j<span class="sy0">,</span>p<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
    m<span class="sy0">:=</span><span class="nu0">27</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span> rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span><span class="kw3">ord</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="kw3">ord</span><span class="br0">&#40;</span><span class="st_h">'@'</span><span class="br0">&#41;</span><span class="sy0">+</span><span class="nu0">1</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span> inc<span class="br0">&#40;</span>ws<span class="br0">&#91;</span>rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> m <span class="kw1">do</span> inc<span class="br0">&#40;</span>ws<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span>ws<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span>n <span class="kw1">downto</span> <span class="nu0">1</span> <span class="kw1">do</span>
        <span class="kw1">begin</span>
            sa<span class="br0">&#91;</span>ws<span class="br0">&#91;</span>rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>i;
            dec<span class="br0">&#40;</span>ws<span class="br0">&#91;</span>rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>
        <span class="kw1">end</span>;
    m<span class="sy0">:=</span><span class="nu0">0</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span>
        <span class="kw1">begin</span>
            <span class="kw1">if</span> rank<span class="br0">&#91;</span>sa<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span>&lt;&gt;rank<span class="br0">&#91;</span>sa<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#93;</span> <span class="kw1">then</span> inc<span class="br0">&#40;</span>m<span class="br0">&#41;</span>;
            trank<span class="br0">&#91;</span>sa<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>m
        <span class="kw1">end</span>;
    j<span class="sy0">:=</span><span class="nu0">1</span>;
    rank<span class="sy0">:=</span>trank;
    <span class="kw1">while</span> m&lt;n <span class="kw1">do</span>
        <span class="kw1">begin</span>
            fillchar<span class="br0">&#40;</span>ws<span class="sy0">,</span>sizeof<span class="br0">&#40;</span>ws<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#41;</span>;
            p<span class="sy0">:=</span><span class="nu0">0</span>;
            <span class="kw1">for</span> i<span class="sy0">:=</span>n<span class="sy0">-</span>j<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span>
                <span class="kw1">begin</span>
                    inc<span class="br0">&#40;</span>p<span class="br0">&#41;</span>;
                    tsa<span class="br0">&#91;</span>p<span class="br0">&#93;</span><span class="sy0">:=</span>i
                <span class="kw1">end</span>;
            <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span> <span class="kw1">if</span> sa<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&gt;j <span class="kw1">then</span>
                <span class="kw1">begin</span>
                    inc<span class="br0">&#40;</span>p<span class="br0">&#41;</span>;
                    tsa<span class="br0">&#91;</span>p<span class="br0">&#93;</span><span class="sy0">:=</span>sa<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">-</span>j
                <span class="kw1">end</span>;
            <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span> trank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>rank<span class="br0">&#91;</span>tsa<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span>;
            <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span> inc<span class="br0">&#40;</span>ws<span class="br0">&#91;</span>trank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
            <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> m <span class="kw1">do</span> inc<span class="br0">&#40;</span>ws<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span>ws<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
            <span class="kw1">for</span> i<span class="sy0">:=</span>n <span class="kw1">downto</span> <span class="nu0">1</span> <span class="kw1">do</span>
                <span class="kw1">begin</span>
                    sa<span class="br0">&#91;</span>ws<span class="br0">&#91;</span>trank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>tsa<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
                    dec<span class="br0">&#40;</span>ws<span class="br0">&#91;</span>trank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>
                <span class="kw1">end</span>;
            m<span class="sy0">:=</span><span class="nu0">0</span>;
            <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span>
                <span class="kw1">begin</span>
                    <span class="kw1">if</span><span class="br0">&#40;</span>rank<span class="br0">&#91;</span>sa<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span>&lt;&gt;rank<span class="br0">&#91;</span>sa<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>rank<span class="br0">&#91;</span>sa<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">+</span>j<span class="br0">&#93;</span>&lt;&gt;rank<span class="br0">&#91;</span>sa<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">+</span>j<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="kw1">then</span> inc<span class="br0">&#40;</span>m<span class="br0">&#41;</span>;
                    trank<span class="br0">&#91;</span>sa<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>m
                <span class="kw1">end</span>;
            rank<span class="sy0">:=</span>trank;
            j<span class="sy0">:=</span>j <span class="kw1">shl</span> <span class="nu0">1</span>
        <span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> Cal_Height;
<span class="kw1">var</span> i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
    j<span class="sy0">:=</span><span class="nu0">0</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span>
        <span class="kw1">begin</span>
            <span class="kw1">if</span> rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">=</span><span class="nu0">1</span> <span class="kw1">then</span> continue;
            k<span class="sy0">:=</span>sa<span class="br0">&#91;</span>rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span>;
            <span class="kw1">while</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>i<span class="sy0">+</span>j<span class="br0">&#93;</span><span class="sy0">=</span>s<span class="br0">&#91;</span>k<span class="sy0">+</span>j<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="kw1">do</span> inc<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
            height<span class="br0">&#91;</span>rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>j;
            <span class="kw1">if</span> j&gt;<span class="nu0">0</span> <span class="kw1">then</span> dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>
        <span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> Build_CTree;
<span class="kw1">var</span> i<span class="sy0">,</span>k<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
    root<span class="sy0">:=</span><span class="nu0">1</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">2</span> <span class="kw1">to</span> n <span class="kw1">do</span>
        <span class="kw1">begin</span>
            k<span class="sy0">:=</span>i<span class="sy0">-</span><span class="nu0">1</span>;
            <span class="kw1">while</span><span class="br0">&#40;</span>k&lt;&gt;root<span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>height<span class="br0">&#91;</span>k<span class="br0">&#93;</span>&gt;height<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw1">do</span> k<span class="sy0">:=</span>a<span class="br0">&#91;</span>k<span class="br0">&#93;</span>;
            <span class="kw1">if</span><span class="br0">&#40;</span>k<span class="sy0">=</span>root<span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>height<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&lt;height<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="kw1">then</span>
                <span class="kw1">begin</span>
                    a<span class="br0">&#91;</span>root<span class="br0">&#93;</span><span class="sy0">:=</span>i;
                    l<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>root;
                    root<span class="sy0">:=</span>i
                <span class="kw1">end</span>
            <span class="kw1">else</span>
                <span class="kw1">begin</span>
                    a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>k;
                    <span class="kw1">if</span> r<span class="br0">&#91;</span>k<span class="br0">&#93;</span>&lt;&gt;<span class="nu0">0</span> <span class="kw1">then</span> a<span class="br0">&#91;</span>r<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>i;
                    l<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>r<span class="br0">&#91;</span>k<span class="br0">&#93;</span>;
                    r<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="sy0">:=</span>i
                <span class="kw1">end</span>;
        <span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> Inqueue<span class="br0">&#40;</span>x<span class="sy0">,</span>y<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">begin</span>
    node<span class="br0">&#91;</span>tot<span class="br0">&#93;</span>.<span class="me1">data</span><span class="sy0">:=</span>y;
    node<span class="br0">&#91;</span>tot<span class="br0">&#93;</span>.<span class="me1">next</span><span class="sy0">:=</span>q<span class="br0">&#91;</span>x<span class="br0">&#93;</span>;
    q<span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="sy0">:=</span>tot
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> Cal_Ques;
<span class="kw1">var</span> i<span class="sy0">,</span>x<span class="sy0">,</span>y<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">shr</span> <span class="nu0">1</span> <span class="kw1">do</span>
        <span class="kw1">begin</span>
            x<span class="sy0">:=</span>rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
            y<span class="sy0">:=</span>rank<span class="br0">&#91;</span>n<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>;
            <span class="kw1">if</span> y&gt;x <span class="kw1">then</span> inc<span class="br0">&#40;</span>x<span class="br0">&#41;</span>
            <span class="kw1">else</span> inc<span class="br0">&#40;</span>y<span class="br0">&#41;</span>;
            <span class="kw1">if</span> x&lt;&gt;y <span class="kw1">then</span>
                <span class="kw1">begin</span>
                    inc<span class="br0">&#40;</span>tot<span class="br0">&#41;</span>;
                    d<span class="br0">&#91;</span>i<span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span>tot;
                    Inqueue<span class="br0">&#40;</span>x<span class="sy0">,</span>y<span class="br0">&#41;</span>;
                    inc<span class="br0">&#40;</span>tot<span class="br0">&#41;</span>;
                    d<span class="br0">&#91;</span>i<span class="sy0">,</span><span class="nu0">2</span><span class="br0">&#93;</span><span class="sy0">:=</span>tot;
                    Inqueue<span class="br0">&#40;</span>y<span class="sy0">,</span>x<span class="br0">&#41;</span>
                <span class="kw1">end</span>
            <span class="kw1">else</span>
                <span class="kw1">begin</span>
                    inc<span class="br0">&#40;</span>tot<span class="br0">&#41;</span>;
                    d<span class="br0">&#91;</span>i<span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span>tot;
                    Inqueue<span class="br0">&#40;</span>x<span class="sy0">,</span>x<span class="br0">&#41;</span>
                <span class="kw1">end</span>;
        <span class="kw1">end</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">2</span> <span class="kw1">to</span> n <span class="kw1">shr</span> <span class="nu0">1</span> <span class="kw1">do</span>
        <span class="kw1">begin</span>
            x<span class="sy0">:=</span>rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
            y<span class="sy0">:=</span>rank<span class="br0">&#91;</span>n<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">2</span><span class="br0">&#93;</span>;
            <span class="kw1">if</span> y&gt;x <span class="kw1">then</span> inc<span class="br0">&#40;</span>x<span class="br0">&#41;</span>
            <span class="kw1">else</span> inc<span class="br0">&#40;</span>y<span class="br0">&#41;</span>;
            <span class="kw1">if</span> x&lt;&gt;y <span class="kw1">then</span>
                <span class="kw1">begin</span>
                    inc<span class="br0">&#40;</span>tot<span class="br0">&#41;</span>;
                    d<span class="br0">&#91;</span>i<span class="sy0">,</span><span class="nu0">3</span><span class="br0">&#93;</span><span class="sy0">:=</span>tot;
                    Inqueue<span class="br0">&#40;</span>x<span class="sy0">,</span>y<span class="br0">&#41;</span>;
                    inc<span class="br0">&#40;</span>tot<span class="br0">&#41;</span>;
                    d<span class="br0">&#91;</span>i<span class="sy0">,</span><span class="nu0">4</span><span class="br0">&#93;</span><span class="sy0">:=</span>tot;
                    Inqueue<span class="br0">&#40;</span>y<span class="sy0">,</span>x<span class="br0">&#41;</span>
                <span class="kw1">end</span>
            <span class="kw1">else</span>
                <span class="kw1">begin</span>
                    inc<span class="br0">&#40;</span>tot<span class="br0">&#41;</span>;
                    d<span class="br0">&#91;</span>i<span class="sy0">,</span><span class="nu0">3</span><span class="br0">&#93;</span><span class="sy0">:=</span>tot;
                    Inqueue<span class="br0">&#40;</span>x<span class="sy0">,</span>x<span class="br0">&#41;</span>
                <span class="kw1">end</span>;
        <span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">function</span> find<span class="br0">&#40;</span>x<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
    <span class="kw1">if</span> f<span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span> exit<span class="br0">&#40;</span>x<span class="br0">&#41;</span>;
    f<span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="sy0">:=</span>find<span class="br0">&#40;</span>f<span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="br0">&#41;</span>;
    exit<span class="br0">&#40;</span>f<span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="br0">&#41;</span>
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> Tarjan<span class="br0">&#40;</span>x<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">var</span> i<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
    vis<span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="sy0">:=</span><span class="kw2">true</span>;
    i<span class="sy0">:=</span>q<span class="br0">&#91;</span>x<span class="br0">&#93;</span>;
    <span class="kw1">while</span> i&lt;&gt;<span class="nu0">0</span> <span class="kw1">do</span>
        <span class="kw1">begin</span>
            <span class="kw1">if</span> vis<span class="br0">&#91;</span>node<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">data</span><span class="br0">&#93;</span> <span class="kw1">then</span> node<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">w</span><span class="sy0">:=</span>height<span class="br0">&#91;</span>find<span class="br0">&#40;</span>node<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">data</span><span class="br0">&#41;</span><span class="br0">&#93;</span>;
            i<span class="sy0">:=</span>node<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">next</span>
        <span class="kw1">end</span>;
    <span class="kw1">if</span> l<span class="br0">&#91;</span>x<span class="br0">&#93;</span>&lt;&gt;<span class="nu0">0</span> <span class="kw1">then</span>
        <span class="kw1">begin</span>
            Tarjan<span class="br0">&#40;</span>l<span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="br0">&#41;</span>;
            f<span class="br0">&#91;</span>l<span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>x
        <span class="kw1">end</span>;
    <span class="kw1">if</span> r<span class="br0">&#91;</span>x<span class="br0">&#93;</span>&lt;&gt;<span class="nu0">0</span> <span class="kw1">then</span>
        <span class="kw1">begin</span>
            Tarjan<span class="br0">&#40;</span>r<span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="br0">&#41;</span>;
            f<span class="br0">&#91;</span>r<span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>x
        <span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> FindAnswer;
<span class="kw1">var</span> i<span class="sy0">,</span>x<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">shr</span> <span class="nu0">1</span> <span class="kw1">do</span>
        <span class="kw1">begin</span>
            x<span class="sy0">:=</span>node<span class="br0">&#91;</span>d<span class="br0">&#91;</span>i<span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#93;</span>.<span class="me1">w</span>;
            <span class="kw1">if</span> x <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">-</span><span class="nu0">1</span>&gt;ans <span class="kw1">then</span>
                <span class="kw1">begin</span>
                    ans<span class="sy0">:=</span>x <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">-</span><span class="nu0">1</span>;
                    start<span class="sy0">:=</span>i<span class="sy0">-</span>x<span class="sy0">+</span><span class="nu0">1</span>
                <span class="kw1">end</span>;
            x<span class="sy0">:=</span>node<span class="br0">&#91;</span>d<span class="br0">&#91;</span>i<span class="sy0">,</span><span class="nu0">2</span><span class="br0">&#93;</span><span class="br0">&#93;</span>.<span class="me1">w</span>;
            <span class="kw1">if</span> x <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">-</span><span class="nu0">1</span>&gt;ans <span class="kw1">then</span>
                <span class="kw1">begin</span>
                    ans<span class="sy0">:=</span>x <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">-</span><span class="nu0">1</span>;
                    start<span class="sy0">:=</span>i<span class="sy0">-</span>x<span class="sy0">+</span><span class="nu0">1</span>
                <span class="kw1">end</span>;
            x<span class="sy0">:=</span>node<span class="br0">&#91;</span>d<span class="br0">&#91;</span>i<span class="sy0">,</span><span class="nu0">3</span><span class="br0">&#93;</span><span class="br0">&#93;</span>.<span class="me1">w</span>;
            <span class="kw1">if</span> x <span class="kw1">shl</span> <span class="nu0">1</span>&gt;ans <span class="kw1">then</span>
                <span class="kw1">begin</span>
                    ans<span class="sy0">:=</span>x <span class="kw1">shl</span> <span class="nu0">1</span>;
                    start<span class="sy0">:=</span>i<span class="sy0">-</span>x
                <span class="kw1">end</span>;
            x<span class="sy0">:=</span>node<span class="br0">&#91;</span>d<span class="br0">&#91;</span>i<span class="sy0">,</span><span class="nu0">4</span><span class="br0">&#93;</span><span class="br0">&#93;</span>.<span class="me1">w</span>;
            <span class="kw1">if</span> x <span class="kw1">shl</span> <span class="nu0">1</span>&gt;ans <span class="kw1">then</span>
                <span class="kw1">begin</span>
                    ans<span class="sy0">:=</span>x <span class="kw1">shl</span> <span class="nu0">1</span>;
                    start<span class="sy0">:=</span>i<span class="sy0">-</span>x
                <span class="kw1">end</span>;
        <span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> Outit;
<span class="kw1">var</span> i<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
    <span class="kw3">writeln</span><span class="br0">&#40;</span>ans<span class="br0">&#41;</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span>g<span class="br0">&#91;</span>start<span class="br0">&#93;</span> <span class="kw1">to</span> g<span class="br0">&#91;</span>start<span class="sy0">+</span>ans<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">do</span> <span class="kw3">write</span><span class="br0">&#40;</span>z<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
    <span class="kw3">writeln</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> Show;
<span class="kw1">var</span> i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
    <span class="kw3">writeln</span><span class="br0">&#40;</span><span class="st_h">'Suffix Array'</span><span class="br0">&#41;</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span>
        <span class="kw1">begin</span>
            <span class="kw3">write</span><span class="br0">&#40;</span>i<span class="sy0">,</span><span class="st_h">':'</span><span class="sy0">,</span>sa<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span><span class="st_h">' '</span><span class="br0">&#41;</span>;
            <span class="kw1">for</span> j<span class="sy0">:=</span>sa<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">to</span> n <span class="kw1">do</span>
                <span class="kw3">write</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="br0">&#41;</span>;
            <span class="kw3">writeln</span>
        <span class="kw1">end</span>;
    <span class="kw3">writeln</span><span class="br0">&#40;</span><span class="st_h">'Rank'</span><span class="br0">&#41;</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span> <span class="kw3">writeln</span><span class="br0">&#40;</span>i<span class="sy0">,</span><span class="st_h">':'</span><span class="sy0">,</span>rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
    <span class="kw3">writeln</span><span class="br0">&#40;</span><span class="st_h">'Height'</span><span class="br0">&#41;</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span> <span class="kw3">writeln</span><span class="br0">&#40;</span>i<span class="sy0">,</span><span class="st_h">':'</span><span class="sy0">,</span>height<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> Main;
<span class="kw1">begin</span>
    Init;
    Double_Solve;
    Cal_Height;
    <span class="co1">//Show;</span>
    Build_CTree;
    Cal_Ques;
    Tarjan<span class="br0">&#40;</span>root<span class="br0">&#41;</span>;
    FindAnswer;
    Outit
<span class="kw1">end</span>;
&#160;
<span class="kw1">begin</span>
    assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'calfflac.in'</span><span class="br0">&#41;</span>;
    reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
    assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'calfflac.out'</span><span class="br0">&#41;</span>;
    rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
    Main;
    close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
    close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>
<span class="kw1">end</span>.</pre></div></div>
<p>&lt;代码一&gt;
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{
ID: starfor1
PROG: calfflac
LANG: PASCAL
}</span>
<span class="kw1">const</span>
  alpha<span class="sy0">:</span><span class="kw4">set</span> <span class="kw1">of</span> <span class="kw4">char</span><span class="sy0">=</span><span class="br0">&#91;</span><span class="st_h">'a'</span>..<span class="st_h">'z'</span><span class="sy0">,</span><span class="st_h">'A'</span>..<span class="st_h">'Z'</span><span class="br0">&#93;</span>;
<span class="kw1">var</span>
  i<span class="sy0">,</span>n<span class="sy0">,</span>f<span class="sy0">,</span>e<span class="sy0">,</span>re<span class="sy0">,</span>le<span class="sy0">,</span>oi<span class="sy0">,</span>oj<span class="sy0">,</span>tf<span class="sy0">,</span>te<span class="sy0">:</span><span class="kw4">word</span>;
  pal<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">20000</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">char</span>;
<span class="kw1">begin</span>
  assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'calfflac.in'</span><span class="br0">&#41;</span>;
  assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'calfflac.out'</span><span class="br0">&#41;</span>;
  reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
  i<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
  <span class="kw1">begin</span>
    inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
    <span class="kw3">read</span><span class="br0">&#40;</span>pal<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
  <span class="kw1">end</span>;
  n<span class="sy0">:=</span>i;
  re<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span>
    <span class="kw1">if</span> pal<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">in</span> alpha <span class="kw1">then</span>
    <span class="kw1">begin</span>
      f<span class="sy0">:=</span>i;
      e<span class="sy0">:=</span>i;
      le<span class="sy0">:=</span><span class="nu0">0</span>;
      <span class="kw1">repeat</span>
        tf<span class="sy0">:=</span>f;
        te<span class="sy0">:=</span>e;
        dec<span class="br0">&#40;</span>f<span class="br0">&#41;</span>;
        inc<span class="br0">&#40;</span>e<span class="br0">&#41;</span>;
        inc<span class="br0">&#40;</span>le<span class="sy0">,</span><span class="nu0">2</span><span class="br0">&#41;</span>;
        <span class="kw1">while</span> <span class="br0">&#40;</span>f&gt;<span class="sy0">=</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="kw1">not</span> <span class="br0">&#40;</span>pal<span class="br0">&#91;</span>f<span class="br0">&#93;</span> <span class="kw1">in</span> alpha<span class="br0">&#41;</span> <span class="kw1">do</span>
          dec<span class="br0">&#40;</span>f<span class="br0">&#41;</span>;
        <span class="kw1">while</span> <span class="br0">&#40;</span>e&lt;<span class="sy0">=</span>n<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="kw1">not</span> <span class="br0">&#40;</span>pal<span class="br0">&#91;</span>e<span class="br0">&#93;</span> <span class="kw1">in</span> alpha<span class="br0">&#41;</span> <span class="kw1">do</span>
          inc<span class="br0">&#40;</span>e<span class="br0">&#41;</span>;
      <span class="kw1">until</span> <span class="br0">&#40;</span>f&lt;<span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>e&gt;n<span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>upcase<span class="br0">&#40;</span>pal<span class="br0">&#91;</span>f<span class="br0">&#93;</span><span class="br0">&#41;</span>&lt;&gt;upcase<span class="br0">&#40;</span>pal<span class="br0">&#91;</span>e<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
      dec<span class="br0">&#40;</span>le<span class="br0">&#41;</span>;
      <span class="kw1">if</span> le&gt;re <span class="kw1">then</span>
      <span class="kw1">begin</span>
        re<span class="sy0">:=</span>le;
        oi<span class="sy0">:=</span>tf;
        oj<span class="sy0">:=</span>te;
      <span class="kw1">end</span>;
      f<span class="sy0">:=</span>i;
      e<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">1</span>;
      <span class="kw1">while</span> <span class="br0">&#40;</span>e&lt;<span class="sy0">=</span>n<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="kw1">not</span> <span class="br0">&#40;</span>pal<span class="br0">&#91;</span>e<span class="br0">&#93;</span> <span class="kw1">in</span> alpha<span class="br0">&#41;</span> <span class="kw1">do</span>
        inc<span class="br0">&#40;</span>e<span class="br0">&#41;</span>;
      <span class="kw1">if</span> <span class="br0">&#40;</span>e&gt;n<span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>upcase<span class="br0">&#40;</span>pal<span class="br0">&#91;</span>f<span class="br0">&#93;</span><span class="br0">&#41;</span>&lt;&gt;upcase<span class="br0">&#40;</span>pal<span class="br0">&#91;</span>e<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">then</span>
        continue;
      le<span class="sy0">:=</span><span class="nu0">0</span>;
      <span class="kw1">repeat</span>
        tf<span class="sy0">:=</span>f;
        te<span class="sy0">:=</span>e;
        dec<span class="br0">&#40;</span>f<span class="br0">&#41;</span>;
        inc<span class="br0">&#40;</span>e<span class="br0">&#41;</span>;
        inc<span class="br0">&#40;</span>le<span class="sy0">,</span><span class="nu0">2</span><span class="br0">&#41;</span>;
        <span class="kw1">while</span> <span class="br0">&#40;</span>f&gt;<span class="sy0">=</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="kw1">not</span> <span class="br0">&#40;</span>pal<span class="br0">&#91;</span>f<span class="br0">&#93;</span> <span class="kw1">in</span> alpha<span class="br0">&#41;</span> <span class="kw1">do</span>
          dec<span class="br0">&#40;</span>f<span class="br0">&#41;</span>;
        <span class="kw1">while</span> <span class="br0">&#40;</span>e&lt;<span class="sy0">=</span>n<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="kw1">not</span> <span class="br0">&#40;</span>pal<span class="br0">&#91;</span>e<span class="br0">&#93;</span> <span class="kw1">in</span> alpha<span class="br0">&#41;</span> <span class="kw1">do</span>
          inc<span class="br0">&#40;</span>e<span class="br0">&#41;</span>;
      <span class="kw1">until</span> <span class="br0">&#40;</span>f&lt;<span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>e&gt;n<span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>upcase<span class="br0">&#40;</span>pal<span class="br0">&#91;</span>f<span class="br0">&#93;</span><span class="br0">&#41;</span>&lt;&gt;upcase<span class="br0">&#40;</span>pal<span class="br0">&#91;</span>e<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
      <span class="kw1">if</span> le&gt;re <span class="kw1">then</span>
      <span class="kw1">begin</span>
        re<span class="sy0">:=</span>le;
        oi<span class="sy0">:=</span>tf;
        oj<span class="sy0">:=</span>te;
      <span class="kw1">end</span>;
    <span class="kw1">end</span>;
  <span class="kw3">writeln</span><span class="br0">&#40;</span>re<span class="br0">&#41;</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span>oi <span class="kw1">to</span> oj <span class="kw1">do</span>
  <span class="kw1">begin</span>
    <span class="kw3">write</span><span class="br0">&#40;</span>pal<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
  <span class="kw1">end</span>;
  <span class="kw3">writeln</span>;
  close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1">&lt;代码二&gt;
<span class="co1">//在代码一基础上修改 算法相同 应用一个过程</span>
<span class="coMULTI">{
ID: Bugs_No1
PROG: calfflac
LANG: PASCAL
}</span>
<span class="kw1">Const</span>
  abc<span class="sy0">=</span><span class="br0">&#91;</span><span class="st_h">'a'</span>..<span class="st_h">'z'</span><span class="sy0">,</span><span class="st_h">'A'</span>..<span class="st_h">'Z'</span><span class="br0">&#93;</span>;
<span class="kw1">Var</span>
  chs<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">20000</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">char</span>;
  lch<span class="sy0">,</span>maxl<span class="sy0">,</span>i<span class="sy0">,</span>lth<span class="sy0">,</span>r<span class="sy0">,</span>l<span class="sy0">,</span>b<span class="sy0">,</span>e<span class="sy0">,</span>mb<span class="sy0">,</span>me<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">Procedure</span> check<span class="br0">&#40;</span><span class="kw3">odd</span><span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
  <span class="kw1">Begin</span>
    lth<span class="sy0">:=</span><span class="nu0">0</span>;   l<span class="sy0">:=</span>i;   r<span class="sy0">:=</span>i<span class="sy0">+</span><span class="kw3">odd</span>;
    <span class="kw1">If</span> <span class="kw3">odd</span><span class="sy0">=</span><span class="nu0">1</span> <span class="kw1">then</span>
      <span class="kw1">Begin</span>
        <span class="kw1">While</span> <span class="br0">&#40;</span>r&lt;<span class="sy0">=</span>lch<span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span><span class="kw1">not</span><span class="br0">&#40;</span>chs<span class="br0">&#91;</span>r<span class="br0">&#93;</span> <span class="kw1">in</span> abc<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span> inc<span class="br0">&#40;</span>r<span class="br0">&#41;</span>;
        <span class="kw1">If</span> <span class="br0">&#40;</span>r&gt;lch<span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>upcase<span class="br0">&#40;</span>chs<span class="br0">&#91;</span>r<span class="br0">&#93;</span><span class="br0">&#41;</span>&lt;&gt;upcase<span class="br0">&#40;</span>chs<span class="br0">&#91;</span>l<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">then</span> exit
      <span class="kw1">End</span>;
    <span class="kw1">Repeat</span>
      b<span class="sy0">:=</span>l;   e<span class="sy0">:=</span>r;
      inc<span class="br0">&#40;</span>lth<span class="sy0">,</span><span class="nu0">2</span><span class="br0">&#41;</span>;
      dec<span class="br0">&#40;</span>l<span class="br0">&#41;</span>;   inc<span class="br0">&#40;</span>r<span class="br0">&#41;</span>;
      <span class="kw1">While</span> <span class="br0">&#40;</span><span class="nu0">1</span>&lt;<span class="sy0">=</span>l<span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span><span class="kw1">not</span> <span class="br0">&#40;</span>chs<span class="br0">&#91;</span>l<span class="br0">&#93;</span> <span class="kw1">in</span> abc<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span> dec<span class="br0">&#40;</span>l<span class="br0">&#41;</span>;
      <span class="kw1">While</span> <span class="br0">&#40;</span>r&lt;<span class="sy0">=</span>lch<span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span><span class="kw1">not</span> <span class="br0">&#40;</span>chs<span class="br0">&#91;</span>r<span class="br0">&#93;</span> <span class="kw1">in</span> abc<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span> inc<span class="br0">&#40;</span>r<span class="br0">&#41;</span>
    <span class="kw1">Until</span> <span class="br0">&#40;</span>l&lt;<span class="nu0">1</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>r&gt;lch<span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>upcase<span class="br0">&#40;</span>chs<span class="br0">&#91;</span>l<span class="br0">&#93;</span><span class="br0">&#41;</span>&lt;&gt;upcase<span class="br0">&#40;</span>chs<span class="br0">&#91;</span>r<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
    dec<span class="br0">&#40;</span>lth<span class="sy0">,</span><span class="nu0">1</span><span class="sy0">-</span><span class="kw3">odd</span><span class="br0">&#41;</span>;
    <span class="kw1">If</span> lth&gt;maxl <span class="kw1">then</span>
      <span class="kw1">Begin</span>
        mb<span class="sy0">:=</span>b;   me<span class="sy0">:=</span>e;   maxl<span class="sy0">:=</span>lth
      <span class="kw1">End</span>
  <span class="kw1">End</span>;
<span class="kw1">Begin</span>
  assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'calfflac.in'</span><span class="br0">&#41;</span>;   reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'calfflac.out'</span><span class="br0">&#41;</span>;   rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
  lch<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">While</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
    <span class="kw1">Begin</span>
      inc<span class="br0">&#40;</span>lch<span class="br0">&#41;</span>; <span class="kw3">read</span><span class="br0">&#40;</span>chs<span class="br0">&#91;</span>lch<span class="br0">&#93;</span><span class="br0">&#41;</span>
    <span class="kw1">End</span>;
  maxl<span class="sy0">:=</span><span class="nu0">1</span>;   mb<span class="sy0">:=</span><span class="nu0">1</span>;   me<span class="sy0">:=</span><span class="nu0">1</span>;
  <span class="kw1">For</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> lch <span class="kw1">do</span>
    <span class="kw1">Begin</span>
      <span class="kw1">If</span> <span class="kw1">not</span><span class="br0">&#40;</span>chs<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">in</span> abc<span class="br0">&#41;</span> <span class="kw1">then</span> continue;
      check<span class="br0">&#40;</span><span class="nu0">0</span><span class="br0">&#41;</span>;   check<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>
    <span class="kw1">End</span>;
  <span class="kw3">writeln</span><span class="br0">&#40;</span>maxl<span class="br0">&#41;</span>;
  <span class="kw1">For</span> i<span class="sy0">:=</span>mb <span class="kw1">to</span> me <span class="kw1">do</span> <span class="kw3">write</span><span class="br0">&#40;</span>chs<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
  <span class="kw3">writeln</span>;
  close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;   close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>
<span class="kw1">End</span>.</pre></div></div>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="co1">//代码3</span>
<span class="coMULTI">{
ID:irache1
LANG:PASCAL
PROB:calfflac
}</span>
<span class="kw1">const</span> maxn<span class="sy0">=</span><span class="nu0">20000</span>;
      inf<span class="sy0">=</span><span class="st_h">'calfflac.in'</span>;
      ouf<span class="sy0">=</span><span class="st_h">'calfflac.out'</span>;
&#160;
<span class="kw1">var</span> a<span class="sy0">,</span>b<span class="sy0">,</span>d<span class="sy0">,</span>info<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="me1">maxn</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">char</span>;
    e<span class="sy0">,</span>el<span class="sy0">,</span>er<span class="sy0">,</span>o<span class="sy0">,</span>next<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="me1">maxn</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">longint</span>;
    lb<span class="sy0">,</span>la<span class="sy0">,</span>n<span class="sy0">,</span>m<span class="sy0">,</span>ans<span class="sy0">,</span>start<span class="sy0">,</span>i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">,</span>p<span class="sy0">:</span><span class="kw4">longint</span>;
&#160;
<span class="kw1">procedure</span> init;
<span class="kw1">begin</span>
 m<span class="sy0">:=</span><span class="nu0">0</span>;
 <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
  <span class="kw1">begin</span>
   inc<span class="br0">&#40;</span>m<span class="br0">&#41;</span>;
   <span class="kw3">read</span><span class="br0">&#40;</span>info<span class="br0">&#91;</span>m<span class="br0">&#93;</span><span class="br0">&#41;</span>;
  <span class="kw1">end</span>;
 n<span class="sy0">:=</span><span class="nu0">0</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> m <span class="kw1">do</span>
  <span class="kw1">if</span> <span class="br0">&#40;</span>info<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&gt;<span class="sy0">=</span><span class="st_h">'A'</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>info<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&lt;<span class="sy0">=</span><span class="st_h">'Z'</span><span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>info<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&gt;<span class="sy0">=</span><span class="st_h">'a'</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>info<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&lt;<span class="sy0">=</span><span class="st_h">'z'</span><span class="br0">&#41;</span>
      <span class="kw1">then</span> <span class="kw1">begin</span>
            inc<span class="br0">&#40;</span>n<span class="br0">&#41;</span>;
            d<span class="br0">&#91;</span>n<span class="br0">&#93;</span><span class="sy0">:=</span>upcase<span class="br0">&#40;</span>info<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
            o<span class="br0">&#91;</span>n<span class="br0">&#93;</span><span class="sy0">:=</span>i;
           <span class="kw1">end</span>;
 ans<span class="sy0">:=</span><span class="nu0">1</span>; start<span class="sy0">:=</span><span class="nu0">1</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> extend_kmp;
<span class="kw1">begin</span>
 k<span class="sy0">:=</span><span class="nu0">0</span>; p<span class="sy0">:=</span><span class="nu0">0</span>; next<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">0</span>; next<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span>lb;
 <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">2</span> <span class="kw1">to</span> lb <span class="kw1">do</span>
  <span class="kw1">begin</span>
   j<span class="sy0">:=</span>next<span class="br0">&#91;</span>i<span class="sy0">-</span>k<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>;
   <span class="kw1">if</span> i<span class="sy0">+</span>j<span class="sy0">-</span><span class="nu0">1</span>&gt;p <span class="kw1">then</span> j<span class="sy0">:=</span>p<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span>;
   <span class="kw1">if</span> j&lt;<span class="nu0">0</span> <span class="kw1">then</span> j<span class="sy0">:=</span><span class="nu0">0</span>;
   <span class="kw1">while</span> <span class="br0">&#40;</span>j<span class="sy0">+</span>i&lt;<span class="sy0">=</span>lb<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>b<span class="br0">&#91;</span>j<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">=</span>b<span class="br0">&#91;</span>j<span class="sy0">+</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw1">do</span>
      inc<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
   next<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>j;
   <span class="kw1">if</span> j<span class="sy0">+</span>i&gt;p <span class="kw1">then</span> <span class="kw1">begin</span>
                  p<span class="sy0">:=</span>i<span class="sy0">+</span>j<span class="sy0">-</span><span class="nu0">1</span>;
                  k<span class="sy0">:=</span>i;
                 <span class="kw1">end</span>;
  <span class="kw1">end</span>;
&#160;
 k<span class="sy0">:=</span><span class="nu0">0</span>; p<span class="sy0">:=</span><span class="nu0">0</span>; e<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">0</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> la <span class="kw1">do</span>
  <span class="kw1">begin</span>
   j<span class="sy0">:=</span>next<span class="br0">&#91;</span>i<span class="sy0">-</span>k<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>;
   <span class="kw1">if</span> i<span class="sy0">+</span>j<span class="sy0">-</span><span class="nu0">1</span>&gt;p <span class="kw1">then</span> j<span class="sy0">:=</span>p<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span>;
   <span class="kw1">if</span> j&lt;<span class="nu0">0</span> <span class="kw1">then</span> j<span class="sy0">:=</span><span class="nu0">0</span>;
   <span class="kw1">while</span> <span class="br0">&#40;</span>j<span class="sy0">+</span>i&lt;<span class="sy0">=</span>la<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>j<span class="sy0">+</span><span class="nu0">1</span>&lt;<span class="sy0">=</span>lb<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>j<span class="sy0">+</span>i<span class="br0">&#93;</span><span class="sy0">=</span>b<span class="br0">&#91;</span>j<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw1">do</span>
      inc<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
   e<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>j;
   <span class="kw1">if</span> j<span class="sy0">+</span>i&gt;p <span class="kw1">then</span> <span class="kw1">begin</span>
                  p<span class="sy0">:=</span>j<span class="sy0">+</span>i<span class="sy0">-</span><span class="nu0">1</span>;
                  k<span class="sy0">:=</span>i;
                 <span class="kw1">end</span>;
  <span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> extend_left<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">,</span>mid<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">begin</span>
 <span class="kw1">for</span> i<span class="sy0">:=</span>l <span class="kw1">to</span> r <span class="kw1">do</span>
  a<span class="br0">&#91;</span>i<span class="sy0">-</span>l<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span>d<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span>l <span class="kw1">to</span> mid <span class="kw1">do</span>
  b<span class="br0">&#91;</span>mid<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span>d<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
 lb<span class="sy0">:=</span>mid<span class="sy0">-</span>l<span class="sy0">+</span><span class="nu0">1</span>; la<span class="sy0">:=</span>r<span class="sy0">-</span>l<span class="sy0">+</span><span class="nu0">1</span>;
 extend_kmp;
 <span class="kw1">for</span> i<span class="sy0">:=</span>l <span class="kw1">to</span> r <span class="kw1">do</span>
  el<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>e<span class="br0">&#91;</span>i<span class="sy0">-</span>l<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>;
 el<span class="br0">&#91;</span>r<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">0</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> extend_right<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">,</span>mid<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">begin</span>
 <span class="kw1">for</span> i<span class="sy0">:=</span>l <span class="kw1">to</span> r <span class="kw1">do</span>
  a<span class="br0">&#91;</span>r<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span>d<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span>mid<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">to</span> r <span class="kw1">do</span>
  b<span class="br0">&#91;</span>i<span class="sy0">-</span>mid<span class="br0">&#93;</span><span class="sy0">:=</span>d<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
 lb<span class="sy0">:=</span>r<span class="sy0">-</span>mid; la<span class="sy0">:=</span>r<span class="sy0">-</span>l<span class="sy0">+</span><span class="nu0">1</span>;
 extend_kmp;
 <span class="kw1">for</span> i<span class="sy0">:=</span>l <span class="kw1">to</span> r <span class="kw1">do</span>
  er<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>e<span class="br0">&#91;</span>r<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>;
 er<span class="br0">&#91;</span>l<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">0</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> work<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">var</span> mid<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
 <span class="kw1">if</span> l<span class="sy0">=</span>r <span class="kw1">then</span> exit;
 mid<span class="sy0">:=</span><span class="br0">&#40;</span>l<span class="sy0">+</span>r<span class="br0">&#41;</span> <span class="kw1">shr</span> <span class="nu0">1</span>;
 work<span class="br0">&#40;</span>l<span class="sy0">,</span>mid<span class="br0">&#41;</span>;
 work<span class="br0">&#40;</span>mid<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">,</span>r<span class="br0">&#41;</span>;
 extend_left<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">,</span>mid<span class="br0">&#41;</span>;
 extend_right<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">,</span>mid<span class="br0">&#41;</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span>l <span class="kw1">to</span> mid <span class="kw1">do</span>
  <span class="kw1">if</span> <span class="br0">&#40;</span>el<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">shl</span> <span class="nu0">1</span>&gt;<span class="sy0">=</span>mid<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>ans&lt;er<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">+</span>mid<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span>
     <span class="kw1">then</span> <span class="kw1">begin</span>
           ans<span class="sy0">:=</span>er<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">+</span>mid<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span>;
           start<span class="sy0">:=</span>i<span class="sy0">-</span>er<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span>;
          <span class="kw1">end</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span>mid<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">to</span> r <span class="kw1">do</span>
  <span class="kw1">if</span> <span class="br0">&#40;</span>er<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">shl</span> <span class="nu0">1</span>&gt;<span class="sy0">=</span>i<span class="sy0">-</span>mid<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>ans&lt;el<span class="br0">&#91;</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">+</span>i<span class="sy0">-</span>mid<span class="br0">&#41;</span>
     <span class="kw1">then</span> <span class="kw1">begin</span>
           ans<span class="sy0">:=</span>el<span class="br0">&#91;</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">+</span>i<span class="sy0">-</span>mid;
           start<span class="sy0">:=</span>mid<span class="sy0">-</span>el<span class="br0">&#91;</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">+</span><span class="nu0">1</span>;
          <span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> out;
<span class="kw1">begin</span>
 <span class="kw3">writeln</span><span class="br0">&#40;</span>ans<span class="br0">&#41;</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span>o<span class="br0">&#91;</span>start<span class="br0">&#93;</span> <span class="kw1">to</span> o<span class="br0">&#91;</span>start<span class="sy0">+</span>ans<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">do</span>
  <span class="kw3">write</span><span class="br0">&#40;</span>info<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
 <span class="kw3">writeln</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">begin</span>
 assign<span class="br0">&#40;</span>input<span class="sy0">,</span>inf<span class="br0">&#41;</span>; reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
 assign<span class="br0">&#40;</span>output<span class="sy0">,</span>ouf<span class="br0">&#41;</span>; rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
 init;
 work<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span>n<span class="br0">&#41;</span>;
 out;
 close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="co1">//代码4</span>
<span class="coMULTI">{
 ID:Wood_st1
 LANG:PASCAL
 TASK:calfflac
}</span>
<span class="kw1">program</span> calfflac_LZX;
<span class="kw1">var</span>
  s<span class="sy0">,</span>str<span class="sy0">:</span><span class="kw4">ansistring</span>;
  c<span class="sy0">:</span><span class="kw4">char</span>;
  ans<span class="sy0">:</span><span class="kw4">integer</span>;
  l<span class="sy0">,</span>len<span class="sy0">,</span>x<span class="sy0">,</span>y<span class="sy0">:</span><span class="kw4">longint</span>;
  a<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">20000</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">integer</span>;
<span class="kw1">procedure</span> pd<span class="br0">&#40;</span>num<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">var</span>
  one<span class="sy0">,</span>i<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
  one<span class="sy0">:=</span><span class="nu0">1</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span>num<span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">downto</span> <span class="nu0">1</span> <span class="kw1">do</span>
  <span class="kw1">if</span> num<span class="sy0">+</span>num<span class="sy0">-</span>i&lt;<span class="sy0">=</span>len <span class="kw1">then</span>
  <span class="kw1">if</span> str<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">=</span>str<span class="br0">&#91;</span>num<span class="sy0">+</span>num<span class="sy0">-</span>i<span class="br0">&#93;</span> <span class="kw1">then</span>
  <span class="kw1">begin</span>
    inc<span class="br0">&#40;</span>one<span class="sy0">,</span><span class="nu0">2</span><span class="br0">&#41;</span>;
    <span class="kw1">if</span> one&gt;ans <span class="kw1">then</span>
    <span class="kw1">begin</span>
      ans<span class="sy0">:=</span>one;
      x<span class="sy0">:=</span>i;
      y<span class="sy0">:=</span>num<span class="sy0">+</span>num<span class="sy0">-</span>i;
    <span class="kw1">end</span>;
  <span class="kw1">end</span> <span class="kw1">else</span> <span class="kw1">break</span>;
  one<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span>num <span class="kw1">downto</span> <span class="nu0">1</span> <span class="kw1">do</span>
  <span class="kw1">if</span> num<span class="sy0">+</span>num<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span>&lt;<span class="sy0">=</span>len <span class="kw1">then</span>
  <span class="kw1">if</span> str<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">=</span>str<span class="br0">&#91;</span>num<span class="sy0">+</span>num<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">then</span>
  <span class="kw1">begin</span>
    inc<span class="br0">&#40;</span>one<span class="sy0">,</span><span class="nu0">2</span><span class="br0">&#41;</span>;
    <span class="kw1">if</span> one&gt;ans <span class="kw1">then</span>
    <span class="kw1">begin</span>
      ans<span class="sy0">:=</span>one;
      x<span class="sy0">:=</span>i;
      y<span class="sy0">:=</span>num<span class="sy0">+</span>num<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span>;
    <span class="kw1">end</span>;
  <span class="kw1">end</span> <span class="kw1">else</span> <span class="kw1">break</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> init;
<span class="kw1">begin</span>
  l<span class="sy0">:=</span><span class="nu0">0</span>;
  len<span class="sy0">:=</span><span class="nu0">0</span>;
  s<span class="sy0">:=</span><span class="st_h">''</span>;
  str<span class="sy0">:=</span><span class="st_h">''</span>;
  <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
  <span class="kw1">begin</span>
    <span class="kw3">read</span><span class="br0">&#40;</span>c<span class="br0">&#41;</span>;
    inc<span class="br0">&#40;</span>l<span class="br0">&#41;</span>;
    s<span class="sy0">:=</span>s<span class="sy0">+</span>c;
    <span class="kw1">if</span> c <span class="kw1">in</span> <span class="br0">&#91;</span><span class="st_h">'a'</span>..<span class="st_h">'z'</span><span class="sy0">,</span><span class="st_h">'A'</span>..<span class="st_h">'Z'</span><span class="br0">&#93;</span> <span class="kw1">then</span>
    <span class="kw1">begin</span>
      inc<span class="br0">&#40;</span>len<span class="br0">&#41;</span>;
      a<span class="br0">&#91;</span>len<span class="br0">&#93;</span><span class="sy0">:=</span>l;
      <span class="kw1">if</span> c <span class="kw1">in</span> <span class="br0">&#91;</span><span class="st_h">'a'</span>..<span class="st_h">'z'</span><span class="br0">&#93;</span> <span class="kw1">then</span> str<span class="sy0">:=</span>str<span class="sy0">+</span><span class="kw3">chr</span><span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>c<span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">32</span><span class="br0">&#41;</span> <span class="kw1">else</span>
      str<span class="sy0">:=</span>str<span class="sy0">+</span>c;
    <span class="kw1">end</span>;
  <span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> main;
<span class="kw1">var</span>
  i<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
  ans<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> len <span class="kw1">do</span> pd<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
  <span class="kw3">writeln</span><span class="br0">&#40;</span>ans<span class="br0">&#41;</span>;
  <span class="kw3">write</span><span class="br0">&#40;</span>copy<span class="br0">&#40;</span>s<span class="sy0">,</span>a<span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="sy0">,</span>a<span class="br0">&#91;</span>y<span class="br0">&#93;</span><span class="sy0">-</span>a<span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
  <span class="kw3">writeln</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">begin</span>
assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'calfflac.in'</span><span class="br0">&#41;</span>;
assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'calfflac.out'</span><span class="br0">&#41;</span>;
reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
  init;
  main;
close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1">代码<span class="nu0">5</span> 此乃传说中的DP算法
&#160;
<span class="coMULTI">{下面的算法有问题（反例：aaa），不过可以过USACO上的数据}</span>
<span class="coMULTI">{
ID: frogl1
PROG: calfflac
LANG: PASCAL
}</span>
<span class="kw1">program</span> calfflac;
<span class="kw1">var</span>
  ch1<span class="sy0">,</span>ch2<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">20000</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">char</span>;
  rec<span class="sy0">,</span>f<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">20000</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">integer</span>;
  pt1<span class="sy0">,</span>pt2<span class="sy0">,</span>maxf<span class="sy0">,</span>maxi<span class="sy0">:</span><span class="kw4">integer</span>;
<span class="kw1">procedure</span> init;
  <span class="kw1">begin</span>
    assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'calfflac.in'</span><span class="br0">&#41;</span>;
    assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'calfflac.out'</span><span class="br0">&#41;</span>;
    reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
    rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
    <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
      <span class="kw1">begin</span>
     	inc<span class="br0">&#40;</span>pt1<span class="br0">&#41;</span>;
        <span class="kw3">read</span><span class="br0">&#40;</span>ch1<span class="br0">&#91;</span>pt1<span class="br0">&#93;</span><span class="br0">&#41;</span>;
	<span class="kw1">if</span> ch1<span class="br0">&#91;</span>pt1<span class="br0">&#93;</span> <span class="kw1">in</span> <span class="br0">&#91;</span><span class="st_h">'a'</span>..<span class="st_h">'z'</span><span class="br0">&#93;</span>
	  <span class="kw1">then</span> <span class="kw1">begin</span>
                 inc<span class="br0">&#40;</span>pt2<span class="br0">&#41;</span>;
		 ch2<span class="br0">&#91;</span>pt2<span class="br0">&#93;</span><span class="sy0">:=</span>upcase<span class="br0">&#40;</span>ch1<span class="br0">&#91;</span>pt1<span class="br0">&#93;</span><span class="br0">&#41;</span>;
	         rec<span class="br0">&#91;</span>pt2<span class="br0">&#93;</span><span class="sy0">:=</span>pt1;
		 <span class="kw1">end</span> <span class="kw1">else</span>
	  <span class="kw1">if</span> ch1<span class="br0">&#91;</span>pt1<span class="br0">&#93;</span> <span class="kw1">in</span> <span class="br0">&#91;</span><span class="st_h">'A'</span>..<span class="st_h">'Z'</span><span class="br0">&#93;</span>
	      <span class="kw1">then</span> <span class="kw1">begin</span>
	             inc<span class="br0">&#40;</span>pt2<span class="br0">&#41;</span>;
                     ch2<span class="br0">&#91;</span>pt2<span class="br0">&#93;</span><span class="sy0">:=</span>ch1<span class="br0">&#91;</span>pt1<span class="br0">&#93;</span>;
		     rec<span class="br0">&#91;</span>pt2<span class="br0">&#93;</span><span class="sy0">:=</span>pt1;
		   <span class="kw1">end</span>;
    	<span class="kw1">end</span>;
    close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  <span class="kw1">end</span>;
<span class="kw1">procedure</span> main;
  <span class="kw1">var</span>
    i<span class="sy0">:</span><span class="kw4">integer</span>;
  <span class="kw1">begin</span>
    f<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">1</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">2</span> <span class="kw1">to</span> pt2 <span class="kw1">do</span>
      <span class="kw1">begin</span>
        <span class="kw1">if</span> <span class="br0">&#40;</span>f<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span>&lt;&gt;i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>ch2<span class="br0">&#91;</span>i<span class="sy0">-</span>f<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">=</span>ch2<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw1">then</span> f<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>f<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">+</span><span class="nu0">2</span>
          <span class="kw1">else</span> <span class="kw1">if</span> ch2<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">=</span>ch2<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">then</span> f<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">2</span>
	  <span class="kw1">else</span> f<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">1</span>;
	<span class="kw1">if</span> f<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&gt;maxf <span class="kw1">then</span> <span class="kw1">begin</span>
	                    maxf<span class="sy0">:=</span>f<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
			    maxi<span class="sy0">:=</span>i;
			  <span class="kw1">end</span>;
      <span class="kw1">end</span>;
    <span class="kw3">writeln</span><span class="br0">&#40;</span>maxf<span class="br0">&#41;</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span>rec<span class="br0">&#91;</span>maxi<span class="sy0">-</span>maxf<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">to</span> rec<span class="br0">&#91;</span>maxi<span class="br0">&#93;</span> <span class="kw1">do</span>
    <span class="kw3">write</span><span class="br0">&#40;</span>ch1<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
    <span class="kw3">writeln</span>;
    close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
  <span class="kw1">end</span>;
<span class="kw1">begin</span>
  init;
  main;
<span class="kw1">end</span>.</pre></div></div>
<p>&lt;朴素的搜索&gt;
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="kw1">program</span> cal;
  <span class="kw1">const</span>
    f01<span class="sy0">=</span><span class="st_h">'calfflac.in'</span>;
    f02<span class="sy0">=</span><span class="st_h">'calfflac.out'</span>;
    nn<span class="sy0">=</span><span class="nu0">80</span>;
    lea<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="st_h">'A'</span>..<span class="st_h">'Z'</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">longint</span><span class="sy0">=</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">2</span><span class="sy0">,</span><span class="nu0">3</span><span class="sy0">,</span><span class="nu0">4</span><span class="sy0">,</span><span class="nu0">5</span><span class="sy0">,</span><span class="nu0">6</span><span class="sy0">,</span><span class="nu0">7</span><span class="sy0">,</span><span class="nu0">8</span><span class="sy0">,</span><span class="nu0">9</span><span class="sy0">,</span><span class="nu0">10</span><span class="sy0">,</span><span class="nu0">11</span><span class="sy0">,</span><span class="nu0">12</span><span class="sy0">,</span><span class="nu0">13</span><span class="sy0">,</span><span class="nu0">14</span><span class="sy0">,</span><span class="nu0">15</span><span class="sy0">,</span><span class="nu0">16</span><span class="sy0">,</span><span class="nu0">17</span><span class="sy0">,</span><span class="nu0">18</span><span class="sy0">,</span><span class="nu0">19</span><span class="sy0">,</span><span class="nu0">20</span><span class="sy0">,</span><span class="nu0">21</span><span class="sy0">,</span><span class="nu0">22</span><span class="sy0">,</span><span class="nu0">23</span><span class="sy0">,</span><span class="nu0">24</span><span class="sy0">,</span><span class="nu0">25</span><span class="sy0">,</span><span class="nu0">26</span><span class="br0">&#41;</span>;
    leb<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="st_h">'a'</span>..<span class="st_h">'z'</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">longint</span><span class="sy0">=</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">2</span><span class="sy0">,</span><span class="nu0">3</span><span class="sy0">,</span><span class="nu0">4</span><span class="sy0">,</span><span class="nu0">5</span><span class="sy0">,</span><span class="nu0">6</span><span class="sy0">,</span><span class="nu0">7</span><span class="sy0">,</span><span class="nu0">8</span><span class="sy0">,</span><span class="nu0">9</span><span class="sy0">,</span><span class="nu0">10</span><span class="sy0">,</span><span class="nu0">11</span><span class="sy0">,</span><span class="nu0">12</span><span class="sy0">,</span><span class="nu0">13</span><span class="sy0">,</span><span class="nu0">14</span><span class="sy0">,</span><span class="nu0">15</span><span class="sy0">,</span><span class="nu0">16</span><span class="sy0">,</span><span class="nu0">17</span><span class="sy0">,</span><span class="nu0">18</span><span class="sy0">,</span><span class="nu0">19</span><span class="sy0">,</span><span class="nu0">20</span><span class="sy0">,</span><span class="nu0">21</span><span class="sy0">,</span><span class="nu0">22</span><span class="sy0">,</span><span class="nu0">23</span><span class="sy0">,</span><span class="nu0">24</span><span class="sy0">,</span><span class="nu0">25</span><span class="sy0">,</span><span class="nu0">26</span><span class="br0">&#41;</span>;
    <span class="kw1">var</span>
      ans<span class="sy0">,</span>x<span class="sy0">,</span>y<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">20000</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">char</span>;
      b<span class="sy0">,</span>a<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">20000</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">longint</span>;
      x1<span class="sy0">:</span><span class="kw4">char</span>;
      left<span class="sy0">,</span>right<span class="sy0">,</span>min<span class="sy0">,</span>i<span class="sy0">,</span>j<span class="sy0">,</span>max<span class="sy0">,</span>la<span class="sy0">,</span>l<span class="sy0">,</span>ans2<span class="sy0">,</span>ans1<span class="sy0">:</span><span class="kw4">longint</span>;
      f1<span class="sy0">,</span>f2<span class="sy0">:</span>text;
      big<span class="sy0">,</span>small<span class="sy0">:</span><span class="kw4">set</span> <span class="kw1">of</span> <span class="kw4">char</span>;
 <span class="kw1">procedure</span> init;
  <span class="kw1">begin</span>
    <span class="kw1">while</span> <span class="kw1">not</span><span class="br0">&#40;</span><span class="kw3">eof</span><span class="br0">&#40;</span>f1<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span>
         <span class="kw1">begin</span>
           <span class="kw3">read</span><span class="br0">&#40;</span>f1<span class="sy0">,</span>x1<span class="br0">&#41;</span>;
           inc<span class="br0">&#40;</span>l<span class="br0">&#41;</span>;
          x<span class="br0">&#91;</span>l<span class="br0">&#93;</span><span class="sy0">:=</span>x1;
         <span class="kw1">end</span>;
         <span class="kw3">readln</span><span class="br0">&#40;</span>f1<span class="br0">&#41;</span>;
    <span class="kw1">end</span>;
    <span class="kw1">procedure</span> change;
     <span class="kw1">begin</span>
                <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> l <span class="kw1">do</span>
            <span class="kw1">begin</span>
              <span class="kw1">if</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>x<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&gt;<span class="sy0">=</span><span class="st_h">'A'</span><span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>x<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&lt;<span class="sy0">=</span><span class="st_h">'Z'</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">then</span>
                 <span class="kw1">begin</span>
                   inc<span class="br0">&#40;</span>la<span class="br0">&#41;</span>;
                   a<span class="br0">&#91;</span>la<span class="br0">&#93;</span><span class="sy0">:=</span>lea<span class="br0">&#91;</span>x<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span>;
                   b<span class="br0">&#91;</span>la<span class="br0">&#93;</span><span class="sy0">:=</span>i;
                 <span class="kw1">end</span>;
          <span class="kw1">if</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>x<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&gt;<span class="sy0">=</span><span class="st_h">'a'</span><span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>x<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&lt;<span class="sy0">=</span><span class="st_h">'z'</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">then</span>
                 <span class="kw1">begin</span>
                   inc<span class="br0">&#40;</span>la<span class="br0">&#41;</span>;
                   a<span class="br0">&#91;</span>la<span class="br0">&#93;</span><span class="sy0">:=</span>leb<span class="br0">&#91;</span>x<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span>;
                   b<span class="br0">&#91;</span>la<span class="br0">&#93;</span><span class="sy0">:=</span>i;
                 <span class="kw1">end</span>;
            <span class="kw1">end</span>;
     <span class="kw1">end</span>;
     <span class="kw1">procedure</span> find;
       <span class="kw1">begin</span>
&#160;
               <span class="kw1">while</span> <span class="br0">&#40;</span>left&gt;<span class="nu0">0</span><span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>right&lt;<span class="sy0">=</span>la<span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>left<span class="br0">&#93;</span><span class="sy0">=</span>a<span class="br0">&#91;</span>right<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw1">do</span>
                 <span class="kw1">begin</span>
                     inc<span class="br0">&#40;</span>min<span class="sy0">,</span><span class="nu0">2</span><span class="br0">&#41;</span>;
                     dec<span class="br0">&#40;</span>left<span class="br0">&#41;</span>;
                     inc<span class="br0">&#40;</span>right<span class="br0">&#41;</span>;
                 <span class="kw1">end</span>;
               <span class="kw1">if</span> min&gt;max <span class="kw1">then</span>
                 <span class="kw1">begin</span>
                  max<span class="sy0">:=</span>min;
                  ans1<span class="sy0">:=</span>b<span class="br0">&#91;</span>left<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>;
                  ans2<span class="sy0">:=</span>b<span class="br0">&#91;</span>right<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span>;
                 <span class="kw1">end</span>;
     <span class="kw1">end</span>;
   <span class="kw1">begin</span>
      assign<span class="br0">&#40;</span>f1<span class="sy0">,</span>f01<span class="br0">&#41;</span>;
      reset<span class="br0">&#40;</span>f1<span class="br0">&#41;</span>;
      assign<span class="br0">&#40;</span>f2<span class="sy0">,</span>f02<span class="br0">&#41;</span>;
      rewrite<span class="br0">&#40;</span>f2<span class="br0">&#41;</span>;
      max<span class="sy0">:=</span><span class="nu0">1</span>;
      l<span class="sy0">:=</span><span class="nu0">0</span>;
       init;
          la<span class="sy0">:=</span><span class="nu0">0</span>;
      change;
            <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> la <span class="kw1">do</span>
             <span class="kw1">begin</span>
               <span class="kw1">if</span> <span class="br0">&#40;</span>i<span class="sy0">+</span><span class="nu0">1</span>&lt;<span class="sy0">=</span>la<span class="br0">&#41;</span> <span class="kw1">then</span>
                  <span class="kw1">if</span> a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">=</span>a<span class="br0">&#91;</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">then</span>
                  <span class="kw1">begin</span>
min<span class="sy0">:=</span><span class="nu0">2</span>;
                    left<span class="sy0">:=</span>i<span class="sy0">-</span><span class="nu0">1</span>;
                    right<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">2</span>;
                    find;
                  <span class="kw1">end</span>;
               <span class="kw1">if</span> <span class="br0">&#40;</span>i<span class="sy0">-</span><span class="nu0">1</span>&gt;<span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">then</span>
                  <span class="kw1">if</span> a<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">=</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">then</span>
                 <span class="kw1">begin</span>
 min<span class="sy0">:=</span><span class="nu0">2</span>;
                   left<span class="sy0">:=</span>i<span class="sy0">-</span><span class="nu0">2</span>;
                   right<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">1</span>;
                   find;
                 <span class="kw1">end</span>;
               <span class="kw1">if</span> <span class="br0">&#40;</span>i<span class="sy0">+</span><span class="nu0">1</span>&lt;<span class="sy0">=</span>la<span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>i<span class="sy0">-</span><span class="nu0">1</span>&gt;<span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">then</span>
                   <span class="kw1">if</span> a<span class="br0">&#91;</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">=</span>a<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">then</span>
                 <span class="kw1">begin</span>
                  min<span class="sy0">:=</span><span class="nu0">3</span>;
                  left<span class="sy0">:=</span>i<span class="sy0">-</span><span class="nu0">2</span>;
                  right<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">2</span>;
                  find;
                 <span class="kw1">end</span>;
         <span class="kw1">end</span>;
        <span class="kw3">writeln</span><span class="br0">&#40;</span>f2<span class="sy0">,</span>max<span class="br0">&#41;</span>;
        <span class="kw1">for</span> i<span class="sy0">:=</span>ans1 <span class="kw1">to</span> ans2 <span class="kw1">do</span>
          <span class="kw3">write</span><span class="br0">&#40;</span>f2<span class="sy0">,</span>x<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
          <span class="kw3">writeln</span><span class="br0">&#40;</span>f2<span class="br0">&#41;</span>;
        close<span class="br0">&#40;</span>f1<span class="br0">&#41;</span>;
        close<span class="br0">&#40;</span>f2<span class="br0">&#41;</span>;
        <span class="kw1">end</span>.
<span class="me1">data</span>
Compiling...
<span class="me1">Compile</span><span class="sy0">:</span> OK
Executing...
   <span class="me1">Test</span> <span class="nu0">1</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">420</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">2</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">424</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">3</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">420</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">4</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">420</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">5</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">424</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">6</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">424</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">7</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">424</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">8</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.184</span> secs<span class="sy0">,</span> <span class="nu0">420</span> KB<span class="br0">&#93;</span>
All tests OK.</pre></div></div>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{
ID:xdwudi01
PROB:calfflac
LANG:PASCAL
}</span>
<span class="kw1">program</span> calfflac;
<span class="kw1">var</span>
  s<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">20000</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">char</span>;
  lch<span class="sy0">,</span>max<span class="sy0">,</span>i<span class="sy0">,</span>first<span class="sy0">,</span>last<span class="sy0">:</span><span class="kw4">integer</span>;
<span class="kw1">procedure</span> check<span class="br0">&#40;</span><span class="kw3">odd</span><span class="sy0">:</span><span class="kw4">byte</span><span class="br0">&#41;</span>;
<span class="kw1">var</span>
  lth<span class="sy0">,</span>l<span class="sy0">,</span>r<span class="sy0">,</span>b<span class="sy0">,</span>e<span class="sy0">:</span><span class="kw4">integer</span>;
<span class="kw1">begin</span>
  l<span class="sy0">:=</span>i; r<span class="sy0">:=</span>i<span class="sy0">+</span><span class="kw3">odd</span>;
  <span class="kw1">if</span> <span class="kw3">odd</span><span class="sy0">=</span><span class="nu0">1</span> <span class="kw1">then</span>
    <span class="kw1">begin</span>
      <span class="kw1">while</span> <span class="br0">&#40;</span>r&lt;<span class="sy0">=</span>lch<span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span><span class="kw1">not</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>r<span class="br0">&#93;</span> <span class="kw1">in</span> <span class="br0">&#91;</span><span class="st_h">'a'</span>..<span class="st_h">'z'</span><span class="sy0">,</span><span class="st_h">'A'</span>..<span class="st_h">'Z'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span> inc<span class="br0">&#40;</span>r<span class="br0">&#41;</span>;
      <span class="kw1">if</span> <span class="br0">&#40;</span>r&gt;lch<span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>upcase<span class="br0">&#40;</span>s<span class="br0">&#91;</span>r<span class="br0">&#93;</span><span class="br0">&#41;</span>&lt;&gt;upcase<span class="br0">&#40;</span>s<span class="br0">&#91;</span>l<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">then</span> exit;
      lth<span class="sy0">:=</span><span class="nu0">0</span>;
    <span class="kw1">end</span>
  <span class="kw1">else</span> lth<span class="sy0">:=-</span><span class="nu0">1</span>;
  <span class="kw1">repeat</span>
    b<span class="sy0">:=</span>l; e<span class="sy0">:=</span>r;
    inc<span class="br0">&#40;</span>lth<span class="sy0">,</span><span class="nu0">2</span><span class="br0">&#41;</span>; dec<span class="br0">&#40;</span>l<span class="br0">&#41;</span>; inc<span class="br0">&#40;</span>r<span class="br0">&#41;</span>;
    <span class="kw1">while</span> <span class="br0">&#40;</span><span class="nu0">1</span>&lt;<span class="sy0">=</span>l<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span><span class="kw1">not</span> <span class="br0">&#40;</span>s<span class="br0">&#91;</span>l<span class="br0">&#93;</span> <span class="kw1">in</span> <span class="br0">&#91;</span><span class="st_h">'a'</span>..<span class="st_h">'z'</span><span class="sy0">,</span><span class="st_h">'A'</span>..<span class="st_h">'Z'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span> dec<span class="br0">&#40;</span>l<span class="br0">&#41;</span>;
    <span class="kw1">while</span> <span class="br0">&#40;</span>r&lt;<span class="sy0">=</span>lch<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span><span class="kw1">not</span> <span class="br0">&#40;</span>s<span class="br0">&#91;</span>r<span class="br0">&#93;</span> <span class="kw1">in</span> <span class="br0">&#91;</span><span class="st_h">'a'</span>..<span class="st_h">'z'</span><span class="sy0">,</span><span class="st_h">'A'</span>..<span class="st_h">'Z'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span> inc<span class="br0">&#40;</span>r<span class="br0">&#41;</span>
  <span class="kw1">until</span> <span class="br0">&#40;</span>l&lt;<span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>r&gt;lch<span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>upcase<span class="br0">&#40;</span>s<span class="br0">&#91;</span>l<span class="br0">&#93;</span><span class="br0">&#41;</span>&lt;&gt;upcase<span class="br0">&#40;</span>s<span class="br0">&#91;</span>r<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
  <span class="kw1">if</span> lth&gt;max <span class="kw1">then</span>
    <span class="kw1">begin</span>
      first<span class="sy0">:=</span>b;
      last<span class="sy0">:=</span>e;
      max<span class="sy0">:=</span>lth;
    <span class="kw1">end</span>;
<span class="kw1">end</span>;
<span class="kw1">begin</span>
  assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'calfflac.in'</span><span class="br0">&#41;</span>;
  assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'calfflac.out'</span><span class="br0">&#41;</span>;
  reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>; rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
  lch<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
    <span class="kw1">begin</span>
      inc<span class="br0">&#40;</span>lch<span class="br0">&#41;</span>; <span class="kw3">read</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>lch<span class="br0">&#93;</span><span class="br0">&#41;</span>;
    <span class="kw1">end</span>;
  max<span class="sy0">:=</span><span class="nu0">1</span>; first<span class="sy0">:=</span><span class="nu0">1</span>; last<span class="sy0">:=</span><span class="nu0">1</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> lch <span class="kw1">do</span>
    <span class="kw1">begin</span>
      <span class="kw1">if</span> <span class="kw1">not</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">in</span> <span class="br0">&#91;</span><span class="st_h">'a'</span>..<span class="st_h">'z'</span><span class="sy0">,</span><span class="st_h">'A'</span>..<span class="st_h">'Z'</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw1">then</span> continue;
      check<span class="br0">&#40;</span><span class="nu0">0</span><span class="br0">&#41;</span>; check<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>;
    <span class="kw1">end</span>;
  <span class="kw3">writeln</span><span class="br0">&#40;</span>max<span class="br0">&#41;</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span>first <span class="kw1">to</span> last <span class="kw1">do</span> <span class="kw3">write</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
  <span class="kw3">writeln</span>;
  close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>; close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<hr />华丽的分隔符-----------
<p>提供一个我想了很久的程序，较短；
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1">USER<span class="sy0">:</span> wang yuren <span class="br0">&#91;</span>wangyur4<span class="br0">&#93;</span>
TASK<span class="sy0">:</span> calfflac
LANG<span class="sy0">:</span> PASCAL
&#160;
Compiling...
<span class="me1">Compile</span><span class="sy0">:</span> OK
&#160;
Executing...
   <span class="me1">Test</span> <span class="nu0">1</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">404</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">2</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">404</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">3</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">404</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">4</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">404</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">5</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.011</span> secs<span class="sy0">,</span> <span class="nu0">404</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">6</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">404</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">7</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">404</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">8</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.540</span> secs<span class="sy0">,</span> <span class="nu0">404</span> KB<span class="br0">&#93;</span>
&#160;
All tests OK.
<span class="kw1">program</span> ccc;
<span class="kw1">var</span>
a<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">200000</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">char</span>;
yun<span class="sy0">,</span>k<span class="sy0">,</span>k1<span class="sy0">,</span>k2<span class="sy0">,</span>i<span class="sy0">,</span>f<span class="sy0">,</span>l<span class="sy0">,</span>r<span class="sy0">,</span>you<span class="sy0">,</span>b<span class="sy0">,</span>c<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">procedure</span> zhao1<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">,</span>kk<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">var</span> z<span class="sy0">,</span>y<span class="sy0">,</span>z1<span class="sy0">,</span>y1<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span> z<span class="sy0">:=</span>l;y<span class="sy0">:=</span>r;z1<span class="sy0">:=</span>l<span class="sy0">+</span><span class="nu0">1</span>;y1<span class="sy0">:=</span>r<span class="sy0">-</span><span class="nu0">1</span>;
<span class="kw1">while</span>  <span class="br0">&#40;</span>z&gt;<span class="sy0">=</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>y&lt;<span class="sy0">=</span>you<span class="br0">&#41;</span> <span class="kw1">do</span>
<span class="kw1">begin</span> <span class="kw1">while</span> z&gt;<span class="sy0">=</span><span class="nu0">1</span> <span class="kw1">do</span> <span class="kw1">if</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>z<span class="br0">&#93;</span>&gt;<span class="sy0">=</span><span class="st_h">'a'</span><span class="br0">&#41;</span><span class="kw3">and</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>z<span class="br0">&#93;</span>&lt;<span class="sy0">=</span><span class="st_h">'z'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>z<span class="br0">&#93;</span>&gt;<span class="sy0">=</span><span class="st_h">'A'</span><span class="br0">&#41;</span><span class="kw3">and</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>z<span class="br0">&#93;</span>&lt;<span class="sy0">=</span><span class="st_h">'Z'</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">break</span> <span class="kw1">else</span> z<span class="sy0">:=</span>z<span class="sy0">-</span><span class="nu0">1</span>;
<span class="kw1">while</span> y&lt;<span class="sy0">=</span>you <span class="kw1">do</span>  <span class="kw1">if</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>y<span class="br0">&#93;</span>&gt;<span class="sy0">=</span><span class="st_h">'a'</span><span class="br0">&#41;</span><span class="kw3">and</span>  <span class="br0">&#40;</span>a<span class="br0">&#91;</span>y<span class="br0">&#93;</span>&lt;<span class="sy0">=</span><span class="st_h">'z'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>y<span class="br0">&#93;</span>&gt;<span class="sy0">=</span><span class="st_h">'A'</span><span class="br0">&#41;</span><span class="kw3">and</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>y<span class="br0">&#93;</span>&lt;<span class="sy0">=</span><span class="st_h">'Z'</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">break</span> <span class="kw1">else</span> y<span class="sy0">:=</span>y<span class="sy0">+</span><span class="nu0">1</span>;
<span class="kw1">if</span> upcase<span class="br0">&#40;</span>a<span class="br0">&#91;</span>z<span class="br0">&#93;</span><span class="br0">&#41;</span>&lt;&gt;upcase<span class="br0">&#40;</span>a<span class="br0">&#91;</span>y<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">begin</span> <span class="kw1">if</span> kk&gt;k <span class="kw1">then</span> <span class="kw1">begin</span> k<span class="sy0">:=</span>kk; k1<span class="sy0">:=</span>z1;k2<span class="sy0">:=</span>y1; <span class="kw1">end</span>; <span class="kw1">break</span>; <span class="kw1">end</span>
<span class="kw1">else</span>
kk<span class="sy0">:=</span>kk<span class="sy0">+</span><span class="nu0">2</span>; <span class="kw1">if</span> kk&gt;k <span class="kw1">then</span> <span class="kw1">begin</span> k<span class="sy0">:=</span>kk; k1<span class="sy0">:=</span>z;k2<span class="sy0">:=</span>y; <span class="kw1">end</span>;
z1<span class="sy0">:=</span>z;y1<span class="sy0">:=</span>y;
z<span class="sy0">:=</span>z<span class="sy0">-</span><span class="nu0">1</span>;y<span class="sy0">:=</span>y<span class="sy0">+</span><span class="nu0">1</span>;
<span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> zhao2<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">,</span>kk<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">var</span> z<span class="sy0">,</span>y<span class="sy0">,</span>z1<span class="sy0">,</span>y1<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span> z<span class="sy0">:=</span>l;y<span class="sy0">:=</span>r;z1<span class="sy0">:=</span>l;y1<span class="sy0">:=</span>r<span class="sy0">-</span><span class="nu0">1</span>;
<span class="kw1">while</span>  <span class="br0">&#40;</span>z&gt;<span class="sy0">=</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>y&lt;<span class="sy0">=</span>you<span class="br0">&#41;</span> <span class="kw1">do</span>
<span class="kw1">begin</span> <span class="kw1">while</span> z&gt;<span class="nu0">1</span> <span class="kw1">do</span> <span class="kw1">if</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>z<span class="br0">&#93;</span>&gt;<span class="sy0">=</span><span class="st_h">'a'</span><span class="br0">&#41;</span><span class="kw3">and</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>z<span class="br0">&#93;</span>&lt;<span class="sy0">=</span><span class="st_h">'z'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>z<span class="br0">&#93;</span>&gt;<span class="sy0">=</span><span class="st_h">'A'</span><span class="br0">&#41;</span><span class="kw3">and</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>z<span class="br0">&#93;</span>&lt;<span class="sy0">=</span><span class="st_h">'Z'</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">break</span> <span class="kw1">else</span> z<span class="sy0">:=</span>z<span class="sy0">-</span><span class="nu0">1</span>&#160;;
<span class="kw1">while</span> y&lt;you <span class="kw1">do</span>  <span class="kw1">if</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>y<span class="br0">&#93;</span>&gt;<span class="sy0">=</span><span class="st_h">'a'</span><span class="br0">&#41;</span><span class="kw3">and</span>  <span class="br0">&#40;</span>a<span class="br0">&#91;</span>y<span class="br0">&#93;</span>&lt;<span class="sy0">=</span><span class="st_h">'z'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>y<span class="br0">&#93;</span>&gt;<span class="sy0">=</span><span class="st_h">'A'</span><span class="br0">&#41;</span><span class="kw3">and</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>y<span class="br0">&#93;</span>&lt;<span class="sy0">=</span><span class="st_h">'Z'</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">break</span> <span class="kw1">else</span> y<span class="sy0">:=</span>y<span class="sy0">+</span><span class="nu0">1</span>;
<span class="kw1">if</span> upcase<span class="br0">&#40;</span>a<span class="br0">&#91;</span>z<span class="br0">&#93;</span><span class="br0">&#41;</span>&lt;&gt;upcase<span class="br0">&#40;</span>a<span class="br0">&#91;</span>y<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">begin</span> <span class="kw1">if</span> kk&gt;k <span class="kw1">then</span> <span class="kw1">begin</span> k<span class="sy0">:=</span>kk; k1<span class="sy0">:=</span>z1;k2<span class="sy0">:=</span>y1; <span class="kw1">end</span>; <span class="kw1">break</span>; <span class="kw1">end</span>
<span class="kw1">else</span>
kk<span class="sy0">:=</span>kk<span class="sy0">+</span><span class="nu0">2</span>; <span class="kw1">if</span> kk&gt;k <span class="kw1">then</span> <span class="kw1">begin</span> k<span class="sy0">:=</span>kk; k1<span class="sy0">:=</span>z;k2<span class="sy0">:=</span>y; <span class="kw1">end</span>;
z1<span class="sy0">:=</span>z;y1<span class="sy0">:=</span>y;
z<span class="sy0">:=</span>z<span class="sy0">-</span><span class="nu0">1</span>;y<span class="sy0">:=</span>y<span class="sy0">+</span><span class="nu0">1</span>;
<span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">begin</span>
assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'calfflac.in'</span><span class="br0">&#41;</span>;assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'calfflac.out'</span><span class="br0">&#41;</span>;
reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
yun<span class="sy0">:=</span><span class="nu0">0</span>;
<span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span> <span class="kw1">begin</span> <span class="kw3">read</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>yun<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span>; yun<span class="sy0">:=</span>yun<span class="sy0">+</span><span class="nu0">1</span>; <span class="kw1">end</span>;
you<span class="sy0">:=</span>yun;
<span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> yun<span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">do</span> <span class="kw1">begin</span>
 <span class="kw1">if</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&gt;<span class="sy0">=</span><span class="st_h">'a'</span><span class="br0">&#41;</span><span class="kw3">and</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&lt;<span class="sy0">=</span><span class="st_h">'z'</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&gt;<span class="sy0">=</span><span class="st_h">'A'</span><span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&lt;<span class="sy0">=</span><span class="st_h">'Z'</span><span class="br0">&#41;</span> <span class="kw1">then</span>
 <span class="kw1">begin</span> b<span class="sy0">:=</span>i<span class="sy0">-</span><span class="nu0">1</span>; c<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">1</span>;
<span class="kw1">while</span> b&gt;<span class="sy0">=</span><span class="nu0">1</span> <span class="kw1">do</span> <span class="kw1">if</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>b<span class="br0">&#93;</span>&gt;<span class="sy0">=</span><span class="st_h">'a'</span><span class="br0">&#41;</span><span class="kw3">and</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>b<span class="br0">&#93;</span>&lt;<span class="sy0">=</span><span class="st_h">'z'</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>b<span class="br0">&#93;</span>&gt;<span class="sy0">=</span><span class="st_h">'A'</span><span class="br0">&#41;</span><span class="kw3">and</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>b<span class="br0">&#93;</span>&lt;<span class="sy0">=</span><span class="st_h">'Z'</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">break</span> <span class="kw1">else</span> b<span class="sy0">:=</span>b<span class="sy0">-</span><span class="nu0">1</span>;
<span class="kw1">while</span> c&lt;<span class="sy0">=</span>you <span class="kw1">do</span>  <span class="kw1">if</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>c<span class="br0">&#93;</span>&gt;<span class="sy0">=</span><span class="st_h">'a'</span><span class="br0">&#41;</span><span class="kw3">and</span>  <span class="br0">&#40;</span>a<span class="br0">&#91;</span>c<span class="br0">&#93;</span>&lt;<span class="sy0">=</span><span class="st_h">'z'</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>c<span class="br0">&#93;</span>&gt;<span class="sy0">=</span><span class="st_h">'A'</span><span class="br0">&#41;</span><span class="kw3">and</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>c<span class="br0">&#93;</span>&lt;<span class="sy0">=</span><span class="st_h">'Z'</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">break</span> <span class="kw1">else</span> c<span class="sy0">:=</span>c<span class="sy0">+</span><span class="nu0">1</span>&#160;;
 <span class="kw1">if</span> upcase<span class="br0">&#40;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">=</span>upcase<span class="br0">&#40;</span>a<span class="br0">&#91;</span>c<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">begin</span> c<span class="sy0">:=</span>c<span class="sy0">+</span><span class="nu0">1</span>;zhao2<span class="br0">&#40;</span>b<span class="sy0">,</span>c<span class="sy0">,</span><span class="nu0">2</span><span class="br0">&#41;</span>; <span class="kw1">end</span>;
 <span class="kw1">if</span> upcase<span class="br0">&#40;</span>a<span class="br0">&#91;</span>b<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">=</span>upcase<span class="br0">&#40;</span>a<span class="br0">&#91;</span>c<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">begin</span> b<span class="sy0">:=</span>b<span class="sy0">-</span><span class="nu0">1</span>;c<span class="sy0">:=</span>c<span class="sy0">+</span><span class="nu0">1</span>;zhao1<span class="br0">&#40;</span>b<span class="sy0">,</span>c<span class="sy0">,</span><span class="nu0">3</span><span class="br0">&#41;</span>; <span class="kw1">end</span>;
 <span class="kw1">end</span>;
 <span class="kw1">end</span>;
<span class="kw3">writeln</span><span class="br0">&#40;</span>k<span class="br0">&#41;</span>;
<span class="kw1">for</span> i<span class="sy0">:=</span>k1 <span class="kw1">to</span> k2 <span class="kw1">do</span> <span class="kw3">write</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
<span class="kw3">writeln</span>;
close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<hr />伪暴搜------------------------
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{ID:无耻的匿了
LANG: PASCAL
TASK: calfflac
}</span>
<span class="kw1">program</span> Project1;
<span class="kw1">var</span> a<span class="sy0">,</span>b<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">20000</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">char</span>;i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">,</span>n<span class="sy0">,</span>m<span class="sy0">,</span>l<span class="sy0">,</span>j1<span class="sy0">,</span>k1<span class="sy0">,</span>max<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="co1">//========================================================</span>
<span class="kw1">begin</span>
assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'calfflac.in'</span><span class="br0">&#41;</span>;reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'calfflac.out'</span><span class="br0">&#41;</span>;rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
n<span class="sy0">:=</span><span class="nu0">1</span>;
<span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
<span class="kw1">begin</span>
<span class="kw3">read</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>n<span class="br0">&#93;</span><span class="br0">&#41;</span>;
inc<span class="br0">&#40;</span>n<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
<span class="co1">//========================================================</span>
dec<span class="br0">&#40;</span>n<span class="br0">&#41;</span>;m<span class="sy0">:=</span><span class="nu0">1</span>;
<span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span>
<span class="kw1">if</span> a<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">in</span> <span class="br0">&#91;</span><span class="st_h">'a'</span>..<span class="st_h">'z'</span><span class="sy0">,</span><span class="st_h">'A'</span>..<span class="st_h">'Z'</span><span class="br0">&#93;</span> <span class="kw1">then</span> <span class="kw1">begin</span> b<span class="br0">&#91;</span>m<span class="br0">&#93;</span><span class="sy0">:=</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;inc<span class="br0">&#40;</span>m<span class="br0">&#41;</span>;<span class="kw1">end</span>;
dec<span class="br0">&#40;</span>m<span class="br0">&#41;</span>;
<span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> m <span class="kw1">do</span>
<span class="kw1">if</span> b<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">in</span><span class="br0">&#91;</span><span class="st_h">'A'</span>..<span class="st_h">'Z'</span><span class="br0">&#93;</span> <span class="kw1">then</span> b<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span><span class="kw3">chr</span><span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="kw3">ord</span><span class="br0">&#40;</span><span class="st_h">'A'</span><span class="br0">&#41;</span><span class="sy0">+</span><span class="kw3">ord</span><span class="br0">&#40;</span><span class="st_h">'a'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
<span class="co1">//=============================================================</span>
<span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">2</span> <span class="kw1">to</span> m<span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">do</span>
<span class="kw1">begin</span>
l<span class="sy0">:=</span><span class="nu0">1</span>;j<span class="sy0">:=</span>i<span class="sy0">-</span><span class="nu0">1</span>;k<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">1</span>;
<span class="kw1">while</span> b<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">=</span>b<span class="br0">&#91;</span>k<span class="br0">&#93;</span> <span class="kw1">do</span> <span class="kw1">begin</span> inc<span class="br0">&#40;</span>l<span class="sy0">,</span><span class="nu0">2</span><span class="br0">&#41;</span>;dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;inc<span class="br0">&#40;</span>k<span class="br0">&#41;</span>;<span class="kw1">end</span>;
<span class="kw1">if</span> l&gt;max <span class="kw1">then</span> <span class="kw1">begin</span> max<span class="sy0">:=</span>l;j1<span class="sy0">:=</span>j<span class="sy0">+</span><span class="nu0">1</span>;k1<span class="sy0">:=</span>k<span class="sy0">-</span><span class="nu0">1</span>;<span class="kw1">end</span>;
l<span class="sy0">:=</span><span class="nu0">0</span>;j<span class="sy0">:=</span>i;k<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">1</span>;
<span class="kw1">while</span> b<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">=</span>b<span class="br0">&#91;</span>k<span class="br0">&#93;</span> <span class="kw1">do</span>  <span class="kw1">begin</span> inc<span class="br0">&#40;</span>l<span class="sy0">,</span><span class="nu0">2</span><span class="br0">&#41;</span>;dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;inc<span class="br0">&#40;</span>k<span class="br0">&#41;</span>;<span class="kw1">end</span>;
<span class="kw1">if</span> l&gt;max <span class="kw1">then</span> <span class="kw1">begin</span> max<span class="sy0">:=</span>l;j1<span class="sy0">:=</span>j<span class="sy0">+</span><span class="nu0">1</span>;k1<span class="sy0">:=</span>k<span class="sy0">-</span><span class="nu0">1</span>;<span class="kw1">end</span>;
<span class="kw1">end</span>;
<span class="co1">//==========================================================</span>
j<span class="sy0">:=</span><span class="nu0">0</span>;
<span class="kw3">writeln</span><span class="br0">&#40;</span>max<span class="br0">&#41;</span>;
<span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span>
<span class="kw1">begin</span>
<span class="kw1">if</span> a<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">in</span> <span class="br0">&#91;</span><span class="st_h">'a'</span>..<span class="st_h">'z'</span><span class="sy0">,</span><span class="st_h">'A'</span>..<span class="st_h">'Z'</span><span class="br0">&#93;</span> <span class="kw1">then</span>  inc<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
<span class="kw1">if</span> <span class="br0">&#40;</span>j&gt;<span class="sy0">=</span>j1<span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>j&lt;<span class="sy0">=</span>k1<span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">begin</span> <span class="kw3">write</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;<span class="kw1">end</span>;
<span class="kw1">if</span> j<span class="sy0">=</span>k1 <span class="kw1">then</span> <span class="kw1">break</span>;
<span class="kw1">end</span>;
<span class="kw3">writeln</span>;
close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<hr />比较短的算法-----------
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{zalazan}</span>
<span class="kw1">program</span> Project1;
<span class="kw1">type</span>
xxxx<span class="sy0">=</span><span class="kw4">record</span>
     letter<span class="sy0">:</span><span class="kw4">char</span>;
     symbol<span class="sy0">:</span><span class="kw4">string</span>;
     <span class="kw1">end</span>;
<span class="kw1">var</span> i<span class="sy0">,</span>o<span class="sy0">:</span>text;
    a<span class="sy0">:</span><span class="kw4">char</span>;
    t<span class="sy0">,</span>n<span class="sy0">,</span>margin<span class="sy0">,</span>first<span class="sy0">,</span>longest<span class="sy0">:</span><span class="kw4">integer</span>;
    letter<span class="sy0">:</span><span class="kw4">array</span> <span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">20000</span><span class="br0">&#93;</span> <span class="kw1">of</span> xxxx;
&#160;
<span class="kw1">begin</span>
   assign <span class="br0">&#40;</span>i<span class="sy0">,</span><span class="st_h">'calfflac.in'</span><span class="br0">&#41;</span>;
   assign<span class="br0">&#40;</span>o<span class="sy0">,</span><span class="st_h">'calfflac.out'</span><span class="br0">&#41;</span>;
   reset<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
   rewrite<span class="br0">&#40;</span>o<span class="br0">&#41;</span>;
&#160;
   <span class="kw1">repeat</span>                         <span class="co1">//读入文件，字母就储存到letter，接着的符号就放到symbol</span>
   <span class="kw3">read</span><span class="br0">&#40;</span>i<span class="sy0">,</span>a<span class="br0">&#41;</span>;
   <span class="kw1">until</span> <span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>upcase<span class="br0">&#40;</span>a<span class="br0">&#41;</span><span class="br0">&#41;</span>&gt;<span class="nu0">64</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>upcase<span class="br0">&#40;</span>a<span class="br0">&#41;</span><span class="br0">&#41;</span>&lt;<span class="nu0">91</span><span class="br0">&#41;</span>;
   letter<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">letter</span><span class="sy0">:=</span>a;
   letter<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">symbol</span> <span class="sy0">:=</span><span class="st_h">''</span>;
   n<span class="sy0">:=</span><span class="nu0">1</span>;
   <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span><span class="br0">&#40;</span>i<span class="br0">&#41;</span> <span class="kw1">do</span>
   <span class="kw1">begin</span>
     <span class="kw3">read</span><span class="br0">&#40;</span>i<span class="sy0">,</span>a<span class="br0">&#41;</span>;
     <span class="kw1">if</span> <span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>upcase<span class="br0">&#40;</span>a<span class="br0">&#41;</span><span class="br0">&#41;</span>&gt;<span class="nu0">64</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>upcase<span class="br0">&#40;</span>a<span class="br0">&#41;</span><span class="br0">&#41;</span>&lt;<span class="nu0">91</span><span class="br0">&#41;</span>
     <span class="kw1">then</span> <span class="kw1">begin</span>
       n<span class="sy0">:=</span>n<span class="sy0">+</span><span class="nu0">1</span>;
       letter<span class="br0">&#91;</span>n<span class="br0">&#93;</span>.<span class="me1">letter</span><span class="sy0">:=</span>a;
       letter<span class="br0">&#91;</span>n<span class="br0">&#93;</span>.<span class="me1">symbol</span> <span class="sy0">:=</span><span class="st_h">''</span>;
     <span class="kw1">end</span>
     <span class="kw1">else</span> <span class="kw1">begin</span>
       letter<span class="br0">&#91;</span>n<span class="br0">&#93;</span>.<span class="me1">symbol</span> <span class="sy0">:=</span> letter<span class="br0">&#91;</span>n<span class="br0">&#93;</span>.<span class="me1">symbol</span><span class="sy0">+</span>a;
     <span class="kw1">end</span>;
   <span class="kw1">end</span>;
&#160;
   first<span class="sy0">:=</span>n;                        <span class="co1">//核心部分，O(n^2)</span>
   longest<span class="sy0">:=</span><span class="nu0">0</span>;
   <span class="kw1">for</span> t<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span>
   <span class="kw1">begin</span>
     margin<span class="sy0">:=</span><span class="nu0">0</span>;
     <span class="kw1">while</span> <span class="br0">&#40;</span>t<span class="sy0">+</span>margin&lt;n<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>t<span class="sy0">-</span>margin&gt;<span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>upcase<span class="br0">&#40;</span>letter<span class="br0">&#91;</span>t<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">+</span>margin<span class="br0">&#93;</span>.<span class="me1">letter</span><span class="br0">&#41;</span> <span class="sy0">=</span> upcase<span class="br0">&#40;</span>letter<span class="br0">&#91;</span>t<span class="sy0">-</span><span class="nu0">1</span><span class="sy0">-</span>margin<span class="br0">&#93;</span>.<span class="me1">letter</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span>
       margin<span class="sy0">:=</span>margin<span class="sy0">+</span><span class="nu0">1</span>;
     <span class="kw1">if</span> longest&lt;<span class="br0">&#40;</span><span class="nu0">2</span><span class="sy0">*</span>margin<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span>
     <span class="kw1">then</span> <span class="kw1">begin</span>
       longest<span class="sy0">:=</span><span class="nu0">2</span><span class="sy0">*</span>margin<span class="sy0">+</span><span class="nu0">1</span>;
       first<span class="sy0">:=</span>t<span class="sy0">-</span>margin;
     <span class="kw1">end</span>;
     margin<span class="sy0">:=</span><span class="nu0">0</span>;
     <span class="kw1">while</span> <span class="br0">&#40;</span>t<span class="sy0">+</span>margin&lt;n<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>t<span class="sy0">-</span>margin&gt;<span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>upcase<span class="br0">&#40;</span>letter<span class="br0">&#91;</span>t<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">+</span>margin<span class="br0">&#93;</span>.<span class="me1">letter</span><span class="br0">&#41;</span><span class="sy0">=</span>upcase<span class="br0">&#40;</span>letter<span class="br0">&#91;</span>t<span class="sy0">-</span>margin<span class="br0">&#93;</span>.<span class="me1">letter</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span>
       margin<span class="sy0">:=</span>margin<span class="sy0">+</span><span class="nu0">1</span>;
     <span class="kw1">if</span> longest&lt;<span class="br0">&#40;</span><span class="nu0">2</span><span class="sy0">*</span>margin<span class="br0">&#41;</span>
     <span class="kw1">then</span> <span class="kw1">begin</span>
       longest<span class="sy0">:=</span><span class="nu0">2</span><span class="sy0">*</span>margin;
       first<span class="sy0">:=</span>t<span class="sy0">-</span>margin<span class="sy0">+</span><span class="nu0">1</span>;
     <span class="kw1">end</span>;
   <span class="kw1">end</span>;
   <span class="kw3">writeln</span><span class="br0">&#40;</span>o<span class="sy0">,</span>longest<span class="br0">&#41;</span>;
&#160;
   <span class="kw1">for</span> t<span class="sy0">:=</span>first <span class="kw1">to</span> first<span class="sy0">+</span>longest<span class="sy0">-</span><span class="nu0">2</span> <span class="kw1">do</span>    <span class="co1">//直接读出  </span>
   <span class="kw1">begin</span>
    <span class="kw3">write</span><span class="br0">&#40;</span>o<span class="sy0">,</span>letter<span class="br0">&#91;</span>t<span class="br0">&#93;</span>.<span class="me1">letter</span><span class="sy0">+</span>letter<span class="br0">&#91;</span>t<span class="br0">&#93;</span>.<span class="me1">symbol</span><span class="br0">&#41;</span>;
   <span class="kw1">end</span>;
   <span class="kw3">write</span><span class="br0">&#40;</span>o<span class="sy0">,</span>letter<span class="br0">&#91;</span>first<span class="sy0">+</span>longest<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">letter</span><span class="br0">&#41;</span>;
   <span class="kw3">writeln</span><span class="br0">&#40;</span>o<span class="sy0">,</span><span class="st_h">''</span><span class="br0">&#41;</span>;  
   close<span class="br0">&#40;</span>o<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<p>很短，但很快：
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{
ID: mxalber1
PROG: calfflac
LANG: PASCAL
}</span>
&#160;
<span class="kw1">program</span> Calfflac;
<span class="kw1">var</span>
  a<span class="sy0">:</span><span class="kw4">array</span> <span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">30000</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">integer</span>;
  b<span class="sy0">:</span><span class="kw4">array</span> <span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">20001</span><span class="sy0">,</span><span class="nu0">0</span>..<span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">integer</span>;
  c<span class="sy0">,</span>d<span class="sy0">:</span><span class="kw4">char</span>;
  la<span class="sy0">,</span>lb<span class="sy0">,</span>i<span class="sy0">,</span>ml<span class="sy0">,</span>mr<span class="sy0">,</span>m<span class="sy0">:</span><span class="kw4">integer</span>;
&#160;
<span class="kw1">procedure</span> work<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">:</span><span class="kw4">integer</span><span class="br0">&#41;</span>;
  <span class="kw1">var</span> i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">integer</span>;
  <span class="kw1">begin</span>
    i<span class="sy0">:=</span><span class="nu0">0</span>;
    <span class="kw1">while</span> b<span class="br0">&#91;</span>l<span class="sy0">-</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">=</span>b<span class="br0">&#91;</span>r<span class="sy0">+</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">do</span>
      inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
    j<span class="sy0">:=</span>i<span class="sy0">*</span><span class="nu0">2</span><span class="sy0">+</span>r<span class="sy0">-</span>l<span class="sy0">+</span><span class="nu0">1</span>;
    <span class="kw1">if</span> j&gt;m <span class="kw1">then</span> <span class="kw1">begin</span>
      m<span class="sy0">:=</span>j;
      ml<span class="sy0">:=</span>l<span class="sy0">-</span>i;
      mr<span class="sy0">:=</span>r<span class="sy0">+</span>i;
    <span class="kw1">end</span>;
  <span class="kw1">end</span>;
&#160;
<span class="kw1">begin</span>
  assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'calfflac.in'</span><span class="br0">&#41;</span>;reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'calfflac.out'</span><span class="br0">&#41;</span>;rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
  <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span> <span class="kw1">begin</span>
    <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eoln</span> <span class="kw1">do</span> <span class="kw1">begin</span>
      <span class="kw3">read</span><span class="br0">&#40;</span>c<span class="br0">&#41;</span>;
      inc<span class="br0">&#40;</span>la<span class="br0">&#41;</span>;
      a<span class="br0">&#91;</span>la<span class="br0">&#93;</span><span class="sy0">:=</span><span class="kw3">ord</span><span class="br0">&#40;</span>c<span class="br0">&#41;</span>;
      d<span class="sy0">:=</span>upcase<span class="br0">&#40;</span>c<span class="br0">&#41;</span>;
      <span class="kw1">if</span> <span class="br0">&#40;</span>d&gt;<span class="sy0">=</span><span class="st_h">'A'</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>d&lt;<span class="sy0">=</span><span class="st_h">'Z'</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">begin</span>
        inc<span class="br0">&#40;</span>lb<span class="br0">&#41;</span>;
        b<span class="br0">&#91;</span>lb<span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">:=</span>la;
        b<span class="br0">&#91;</span>lb<span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="kw3">ord</span><span class="br0">&#40;</span>d<span class="br0">&#41;</span>;
      <span class="kw1">end</span>;
    <span class="kw1">end</span>;
    <span class="kw3">readln</span>;
    inc<span class="br0">&#40;</span>la<span class="br0">&#41;</span>;
    a<span class="br0">&#91;</span>la<span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">end</span>;
  m<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> lb <span class="kw1">do</span> <span class="kw1">begin</span>
    work<span class="br0">&#40;</span>i<span class="sy0">,</span>i<span class="br0">&#41;</span>;
    <span class="kw1">if</span> b<span class="br0">&#91;</span>i<span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">=</span>b<span class="br0">&#91;</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">then</span>
      work<span class="br0">&#40;</span>i<span class="sy0">,</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span>;
  <span class="kw1">end</span>;
  <span class="kw3">writeln</span><span class="br0">&#40;</span>m<span class="br0">&#41;</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span>b<span class="br0">&#91;</span>ml<span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="kw1">to</span> b<span class="br0">&#91;</span>mr<span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="kw1">do</span> <span class="kw1">begin</span>
    <span class="kw1">if</span> a<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&gt;<span class="nu0">0</span>
      <span class="kw1">then</span> <span class="kw3">write</span><span class="br0">&#40;</span><span class="kw3">chr</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
      <span class="kw1">else</span> <span class="kw3">writeln</span>;
  <span class="kw1">end</span>;
  <span class="kw3">writeln</span>;
  close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<p>USER: Chang Albert [mxalber1]
TASK: calfflac
LANG: PASCAL
</p><p>Compiling...
Compile: OK
</p><p>Executing...
</p>
<pre>  Test 1: TEST OK [0.000 secs, 412 KB]
  Test 2: TEST OK [0.000 secs, 412 KB]
  Test 3: TEST OK [0.000 secs, 412 KB]
  Test 4: TEST OK [0.000 secs, 412 KB]
  Test 5: TEST OK [0.000 secs, 412 KB]
  Test 6: TEST OK [0.000 secs, 412 KB]
  Test 7: TEST OK [0.000 secs, 412 KB]
  Test 8: TEST OK [0.081 secs, 412 KB]
</pre>
<p>All tests OK.
</p><p><br />
既然暴搜,就写短点:
{
ID:wait_dr1
PROG:calfflac
LANG:PASCAL
}
type
</p>
<pre> ss=array [1..20000]of char;
</pre>
<p>var
</p>
<pre> m,n,ans,start:longint;
 o:array [1..20000]of longint;
 info,d:ss;
 ch:char;
</pre>
<p>procedure init;
</p>
<pre> var
   i:longint;
 begin
   assign(input,'calfflac.in');reset(input);
   assign(output,'calfflac.out');rewrite(output);
   n:=0;
   m:=0;
   while not eof do
    begin
      read(ch);
      inc(m);
      info[m]:=ch;
       if info[m] in ['a'..'z','A'..'Z']then
         begin
           inc(n);
           d[n]:=upcase(info[m]);
           o[n]:=m;
         end;
     end;
    ans:=1;start:=1;
 end;
</pre>
<p>procedure search1(x:longint);
</p>
<pre> var
   i,j:longint;
 begin
   j:=1;
   for i:=x+1 to n do
     begin
       if 2*x-i&lt;=0 then break;
       if d[i]=d[2*x-i]then inc(j) else break;
     end;
   if j*2-1&gt;ans then begin ans:=(j-1)*2+1;start:=x-j+1;end;
 end;
</pre>
<p>procedure search2(x:longint);
</p>
<pre> var
   i,j:longint;
 begin
   j:=0;
   for i:=x+1 to n do
     begin
       if 2*x+1-i&lt;=0 then break;
       if d[i]=d[2*x+1-i]then inc(j)else break;
     end;
     if j*2&gt;ans then begin ans:=j*2;start:=x-j+1;end;
 end;
</pre>
<p>procedure solve;
</p>
<pre> var
   i,j:longint;
 begin
   ans:=-maxint;
   for i:=1 to n-1 do
     begin
       search1(i);
       search2(i);
     end;
 end;
</pre>
<p>procedure print;
</p>
<pre> var
   i:longint;
 begin
   writeln(ans);  
   for i:=o[start] to o[start-1+ans]do
     write(info[i]);
   writeln;
   close(output);
 end;
</pre>
<p>begin
</p>
<pre> init;
 solve;
 print;
</pre>
<p>end.
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1">   Test <span class="nu0">1</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">312</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">2</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">312</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">3</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">312</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">4</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">312</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">5</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">312</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">6</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">312</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">7</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">312</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">8</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.065</span> secs<span class="sy0">,</span> <span class="nu0">312</span> KB<span class="br0">&#93;</span>
&#160;
<span class="coMULTI">{
ID: happyzh2
PROG: calfflac
LANG: PASCAL
}</span>
<span class="kw1">var</span> ch<span class="sy0">:</span><span class="kw4">char</span>;
    s1<span class="sy0">,</span>s2<span class="sy0">:</span><span class="kw4">ansistring</span>;
    a<span class="sy0">:</span><span class="kw4">array</span> <span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">20000</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">word</span>;
    i<span class="sy0">,</span>j<span class="sy0">,</span>a1<span class="sy0">,</span>a2<span class="sy0">:</span><span class="kw4">word</span>;
<span class="kw1">begin</span>
 assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'calfflac.in'</span><span class="br0">&#41;</span>; reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>; assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'calfflac.out'</span><span class="br0">&#41;</span>; rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
 <span class="kw1">repeat</span> <span class="kw3">read</span><span class="br0">&#40;</span>ch<span class="br0">&#41;</span>; s1<span class="sy0">:=</span>s1<span class="sy0">+</span>ch; <span class="kw1">until</span> <span class="kw3">eof</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>s1<span class="br0">&#41;</span> <span class="kw1">do</span>
  <span class="kw1">if</span> s1<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">in</span> <span class="br0">&#91;</span><span class="st_h">'a'</span>..<span class="st_h">'z'</span><span class="sy0">,</span><span class="st_h">'A'</span>..<span class="st_h">'Z'</span><span class="br0">&#93;</span> <span class="kw1">then</span>
   <span class="kw1">begin</span> s2<span class="sy0">:=</span>s2<span class="sy0">+</span>upcase<span class="br0">&#40;</span>s1<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>; a<span class="br0">&#91;</span>length<span class="br0">&#40;</span>s2<span class="br0">&#41;</span><span class="br0">&#93;</span><span class="sy0">:=</span>i; <span class="kw1">end</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">2</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>s2<span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">do</span>
  <span class="kw1">begin</span>
   <span class="kw1">while</span> <span class="br0">&#40;</span>s2<span class="br0">&#91;</span>i<span class="sy0">-</span>j<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">=</span>s2<span class="br0">&#91;</span>i<span class="sy0">+</span>j<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>i<span class="sy0">-</span>j<span class="sy0">-</span><span class="nu0">1</span>&gt;<span class="sy0">=</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>i<span class="sy0">+</span>j<span class="sy0">+</span><span class="nu0">1</span>&lt;<span class="sy0">=</span>length<span class="br0">&#40;</span>s2<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span>
    inc<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
   <span class="kw1">if</span> j<span class="sy0">+</span>j<span class="sy0">+</span><span class="nu0">1</span>&gt;a2<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">-</span>a1 <span class="kw1">then</span>
    <span class="kw1">begin</span> a1<span class="sy0">:=</span>i<span class="sy0">-</span>j; a2<span class="sy0">:=</span>i<span class="sy0">+</span>j; <span class="kw1">end</span>;
   j<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">end</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">2</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>s2<span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">2</span> <span class="kw1">do</span>
  <span class="kw1">if</span> s2<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">=</span>s2<span class="br0">&#91;</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">then</span>
   <span class="kw1">begin</span>
    <span class="kw1">while</span> <span class="br0">&#40;</span>s2<span class="br0">&#91;</span>i<span class="sy0">-</span>j<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">=</span>s2<span class="br0">&#91;</span>i<span class="sy0">+</span><span class="nu0">2</span><span class="sy0">+</span>j<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>i<span class="sy0">-</span>j<span class="sy0">-</span><span class="nu0">1</span>&gt;<span class="sy0">=</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>i<span class="sy0">+</span><span class="nu0">2</span><span class="sy0">+</span>j&lt;<span class="sy0">=</span>length<span class="br0">&#40;</span>s2<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span>
     inc<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
    <span class="kw1">if</span> j<span class="sy0">+</span>j<span class="sy0">+</span><span class="nu0">2</span>&gt;a2<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">-</span>a1 <span class="kw1">then</span>
     <span class="kw1">begin</span> a1<span class="sy0">:=</span>i<span class="sy0">-</span>j; a2<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">+</span>j; <span class="kw1">end</span>;
    j<span class="sy0">:=</span><span class="nu0">0</span>;
   <span class="kw1">end</span>;
 <span class="kw3">writeln</span><span class="br0">&#40;</span>a2<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">-</span>a1<span class="br0">&#41;</span>;
 <span class="kw3">writeln</span><span class="br0">&#40;</span>copy<span class="br0">&#40;</span>s1<span class="sy0">,</span>a<span class="br0">&#91;</span>a1<span class="br0">&#93;</span><span class="sy0">,</span>a<span class="br0">&#91;</span>a2<span class="br0">&#93;</span><span class="sy0">+</span><span class="nu0">1</span><span class="sy0">-</span>a<span class="br0">&#91;</span>a1<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
 close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>; close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>

<!-- 
NewPP limit report
Preprocessor node count: 52/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key newnocow:pcache:idhash:187-0!*!*!*!*!*!* and timestamp 20131219164858 -->
</div><div class="printfooter">
来自“<a href="http://www.nocow.cn/index.php?title=Code:USACO/calfflac/Pascal&amp;oldid=32933">http://www.nocow.cn/index.php?title=Code:USACO/calfflac/Pascal&amp;oldid=32933</a>”</div>
		<div id='catlinks' class='catlinks catlinks-allhidden'></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>查看</h5>
		<div class="pBody">
			<ul>
				<li id="ca-nstab-code" class="selected"><a href="Pascal.html">代码</a></li>
				<li id="ca-talk"><a href="http://www.nocow.cn/index.php/Code_Talk:USACO/calfflac/Pascal" title="关于内容页面的讨论 [t]" accesskey="t">讨论</a></li>
				<li id="ca-edit"><a href="http://www.nocow.cn/index.php?title=Code:USACO/calfflac/Pascal&amp;action=edit" title="你可以编辑本页。请在保存前预览一下。 [e]" accesskey="e">编辑</a></li>
				<li id="ca-history"><a href="http://www.nocow.cn/index.php?title=Code:USACO/calfflac/Pascal&amp;action=history" title="本页面的早前修订版本 [h]" accesskey="h">历史</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>个人工具</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="http://www.nocow.cn/index.php?title=%E7%89%B9%E6%AE%8A:%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95&amp;returnto=Code%3AUSACO%2Fcalfflac%2FPascal" title="我们希望您可以登入，但不强求 [o]" accesskey="o">登录/创建账户</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a title="访问首页" style="background-image: url(http://www.nocow.cn/skins/common/images/wiki.png);" href="../../%2596页.html"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class="generated-sidebar portlet" id="p-navigation">
		<h5>导航</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage"><a href="../../%2596页.html" title="访问首页 [z]" accesskey="z">首页</a></li>
				<li id="n-portal"><a href="http://www.nocow.cn/index.php/NOCOW:%E7%A4%BE%E5%8C%BA%E4%B8%BB%E9%A1%B5" title="关于本项目，你可以做什么，在哪里找到你需要的事物">社区主页</a></li>
				<li id="n-currentevents"><a href="http://www.nocow.cn/index.php/NOCOW:NOCOW%E8%BF%91%E6%9C%9F%E5%8F%91%E5%B1%95%E8%AE%A1%E5%88%92" title="查看当前事件的背景信息">当前事件</a></li>
				<li id="n-recentchanges"><a href="http://www.nocow.cn/index.php/%E7%89%B9%E6%AE%8A:%E6%9C%80%E8%BF%91%E6%9B%B4%E6%94%B9" title="本wiki的最近更改列表 [r]" accesskey="r">最近更改</a></li>
				<li id="n-randompage"><a href="http://www.nocow.cn/index.php/%E7%89%B9%E6%AE%8A:%E9%9A%8F%E6%9C%BA%E9%A1%B5%E9%9D%A2" title="随机进入一个页面 [x]" accesskey="x">随机页面</a></li>
				<li id="n-help"><a href="http://www.nocow.cn/index.php/%E5%B8%AE%E5%8A%A9:%E7%9B%AE%E5%BD%95" title="寻求帮助的地方">使用帮助</a></li>
				<li id="n-sitemap-text"><a href="http://www.nocow.cn/index.php/NOCOW%E5%9C%B0%E5%9B%BE">NOCOW地图</a></li>
				<li id="n-sandbox-text"><a href="http://www.nocow.cn/index.php/NOCOW:%E6%96%B0%E6%89%8B%E8%AF%95%E7%BB%83%E5%9C%BA">新手试练场</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">搜索</label></h5>
		<div id="searchBody" class="pBody">
			<form action="http://www.nocow.cn/index.php" id="searchform">
				<input type='hidden' name="title" value="特殊:搜索"/>
				<input type="search" name="search" title="在NOCOW中搜索 [f]" accesskey="f" id="searchInput" />
				<input type="submit" name="go" value="进入" title="如果相同的标题存在的话便直接前往该页面" id="searchGoButton" class="searchButton" />&#160;
				<input type="submit" name="fulltext" value="搜索" title="搜索含这些文字的页面" id="mw-searchButton" class="searchButton" />
			</form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>工具箱</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="http://www.nocow.cn/index.php/%E7%89%B9%E6%AE%8A:%E9%93%BE%E5%85%A5%E9%A1%B5%E9%9D%A2/Code:USACO/calfflac/Pascal" title="所有链入本页的wiki页面列表 [j]" accesskey="j">链入页面</a></li>
				<li id="t-recentchangeslinked"><a href="http://www.nocow.cn/index.php/%E7%89%B9%E6%AE%8A:%E9%93%BE%E5%87%BA%E6%9B%B4%E6%94%B9/Code:USACO/calfflac/Pascal" title="本页链入的页面的最近更改 [k]" accesskey="k">链出更改</a></li>
				<li id="t-specialpages"><a href="http://www.nocow.cn/index.php/%E7%89%B9%E6%AE%8A:%E7%89%B9%E6%AE%8A%E9%A1%B5%E9%9D%A2" title="所有特殊页面列表 [q]" accesskey="q">特殊页面</a></li>
				<li><a href="http://www.nocow.cn/index.php?title=Code:USACO/calfflac/Pascal&amp;printable=yes" rel="alternate">可打印版</a></li>
				<li id="t-permalink"><a href="http://www.nocow.cn/index.php?title=Code:USACO/calfflac/Pascal&amp;oldid=32933" title="本页面该修订版本的永久链接">永久链接</a></li>
			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
<div id="footer">
	<div id="f-copyrightico">
		<a href="http://www.gnu.org/copyleft/fdl.html"><img src="http://www.nocow.cn/skins/common/images/gnu-fdl.png" alt="GNU Free Documentation License 1.2" width="88" height="31" /></a>
	</div>
	<div id="f-poweredbyico">
		<a href="http://www.mediawiki.org/"><img src="http://www.nocow.cn/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
	</div>
	<ul id="f-list">
		<li id="viewcount">此页面已被浏览过9,832次。</li>
		<li id="credits">本页面由NOCOW匿名用户<a href="http://www.nocow.cn/index.php/%E7%89%B9%E6%AE%8A:%E7%94%A8%E6%88%B7%E8%B4%A1%E7%8C%AE/183.4.76.99" title="特殊:用户贡献/183.4.76.99">183.4.76.99</a>于2013年6月1日 (星期六) 14:17做出最后修改。 在<a href="http://www.nocow.cn/index.php/%E7%94%A8%E6%88%B7:Xuanya02" title="用户:Xuanya02">炸毛璇</a>和<a href="http://www.nocow.cn/index.php/%E7%94%A8%E6%88%B7:Mxalbert1996" title="用户:Mxalbert1996">张正庆</a>、NOCOW匿名用户<a href="http://www.nocow.cn/index.php/%E7%89%B9%E6%AE%8A:%E7%94%A8%E6%88%B7%E8%B4%A1%E7%8C%AE/61.133.116.26" title="特殊:用户贡献/61.133.116.26">61.133.116.26</a>和<a href="http://www.nocow.cn/index.php/%E7%89%B9%E6%AE%8A:%E7%94%A8%E6%88%B7%E8%B4%A1%E7%8C%AE/108.6.15.38" title="特殊:用户贡献/108.6.15.38">108.6.15.38</a>和<a href="http://www.nocow.cn/index.php?title=Code:USACO/calfflac/Pascal&amp;action=credits" title="Code:USACO/calfflac/Pascal">其他</a>的工作基础上。</li>
		<li id="copyright">本站全部文字内容使用<a class="external" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.2</a>授权。</li>
		<li id="privacy"><a href="http://www.nocow.cn/index.php/NOCOW:%E9%9A%90%E7%A7%81%E6%9D%83%E6%94%BF%E7%AD%96" title="NOCOW:隐私权政策">隐私权政策</a></li>
		<li id="about"><a href="http://www.nocow.cn/index.php/NOCOW:%E5%85%B3%E4%BA%8E" title="NOCOW:关于">关于NOCOW</a></li>
		<li id="disclaimer"><a href="http://www.nocow.cn/index.php/NOCOW:%E5%85%8D%E8%B4%A3%E5%A3%B0%E6%98%8E" title="NOCOW:免责声明">免责声明</a></li>
		<li id="miibeian"><a href="http://www.miibeian.gov.cn" rel="nofollow">陕ICP备09005692号</a></li>
	</ul>
</div>
</div>
<script>if(window.mw){
	mw.loader.load(["mediawiki.user", "mediawiki.util", "mediawiki.page.ready", "mediawiki.legacy.wikibits", "mediawiki.legacy.ajax"]);
}
</script>
<script src="http://www.nocow.cn/load.php?debug=false&amp;lang=zh-cn&amp;modules=site&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
	mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":5,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"monobook","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,
	"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"zh-cn","language":"zh-cn","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"searchNs100":true,"searchNs101":false,"searchNs102":true,"searchNs103":false,"searchNs104":false,"searchNs105":false,"searchNs106":true,"searchNs107":false,"searchNs108":true,"searchNs109":false,"searchNs110":true,"searchNs111":false,"searchNs112":true,"searchNs113":false,"searchNs114":true,"searchNs115":true,"searchNs116":true,"searchNs117":false,"searchNs118":true,"searchNs119":false,"searchNs120":true,"searchNs121":false,"searchNs122":true,"searchNs123":false,"searchNs124":true,"searchNs125":false,"searchNs126":true,
	"searchNs127":false});;mw.user.tokens.set({"editToken":"+\\","watchToken":false});;mw.loader.state({"user.options":"ready","user.tokens":"ready"});
	
	/* cache key: newnocow:resourceloader:filter:minify-js:4:9d09b6dc2353a89934e2338dc02930d3 */
}
</script><!-- Served in 0.850 secs. --><!-- google analytics -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-8008676-1");
pageTracker._trackPageview();
} catch(err) {}
</script></body></html>